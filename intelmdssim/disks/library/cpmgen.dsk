ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееее MAC     COM   \           BIOS21I ASM  7	
     DISKDEF LIB   1             BIOS21I PRN  Ђ!"#$%&'( BIOS21I HEX    *               BIOS21I PRN  E)+,-.            BIOS21I SYM   /0               BOOT    ASM A 12               BOOT    PRN   '345              BOOT    HEX   7                BOOT    SYM   6               ееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееееГ( COPYRIGHT (C) 1977 DIGITAL RESEARCH 1 1Ї2O02Z0НЂ%Н!  "ЦНKЇ2Ј.> 2¤.*M0"$/ННѓ%!  "Г"Ю:g0·Кi! "P0"R0"ЗЇ2НН:0юКvюВЛ:	0ю$ВХНкВ :[0 ю-К¬ю+К¬ю*В ЕНБ:[0!_0юMКД!f0юPВ pНГ	юВ Н!КНН	ВмН:O0·ДњГйНюВй!  "а:O0·КНл*V0}“|љЪ<НrННЄВБ*Г|µДґ:O0·В_Н‘НHН*V0"ГГ™*V0"аНEН	КVНюВ»ГННЄВ»*ал*ШНЭВ»"ГГ™*K0е"X0!0NA#~ЕеН'бБВ~бp"K0Й*K0N"X0!0q#ЕеН*бБwВњЙ:0юАН!АюАxю	ЙНњГХ*V0еНф*R0:_0·МЌб"V0Н2В*M0е·КrГ ю;ИюИю
ИюИю!Й:В·КrН:0юВF:	0НзКeю%В;Нm"Ь>я2Ы:0юВb:	0хЇ20ННЫсГWю,ВFНЧГцНЫН:0юВb:	0НзКeю,КцНґ:В·КrНЧГe*X0#е![0~НнК‡НГwЇw2/Н¬:Н2T/Н-б"ф.б"$/Ї2/>2¤.Гv:Ј.·Кё!‘/6+Н•%>20Й:Ј.·К®:¤.юРюИН0ГБЇ20Н9Н$Н<!В5Й*Г}ґДў*V0"ГН:0юВy:	0ю:ВyГvюВ!X ! ^#fkйX¤»Щ _~™0^ўД	Й	Z
щ
ь
я
258Ё« НфН:0юВ‰:0=К‰G!	0КѓЕF#еН2бБГsНГ–Н*I0Н|EН2НгНVю,К[ГХНфНЉНmл*R0"R0"P0ГХНфНmеEН2бDН2НгНVю,КѕГХНфНЉ:Њ/ю ВХНm:Њ/ю Вх"З> 2Њ/:Н·Д®Н:0юВ :	0ю
В Г-НфНІ	Г	ЕНфНБ!‘/6+:¤.юТ;БН?Г*$/е*ґ."$/Н?б"$/сюВ:¤.юВl*ґ.^#V{ІКr+sГ5*ґ.^#VюК·К“:¤.юВ r+s!06#wГљ>Ї20Н9Г!e/~х6 ![0~х6 л"ф.~Ц,ВЕ#е!0wН9бГреНСНдГРН9*ф.~·Ва6Гч*веН:	0ю,ДґбНоЇ2f/л*ґ.s#rс2[0с2e/*ґ.#"X0Н$Н<Г5Н¬*$/"M0Н0:T/2Н:/2[0·Д	Гv>20*Ф."ф.Ї2[0Гvх*R0еНm"R0НЌб"R0с!’/wЙНкК >=НG*R0е*I0"R0Нфб"R0ГХНфНm:Њ/ю ВБ}>ТБНћ	ГХНкВҐНўГХ:O0·КИ*V0л*ШНЭКїНњГНН"ШГН>НЇ2Ъ:O0·МН:0юВ:O0·М!!Ъ4Н:0юВ:	0ю,КШ>Н"К4:O0·:ЪМГ	ю	ИюИюИюЙ2\0:0юВ=:	0юКFю!КFюИНґНГ%*X0"`0>2Z0Н*X0"аН:0юВk:	0юИюВTН!ВTх:\0юВ¦:O0·В¦:0=К¦К¦Е*а"X0Н	!Н':[0·Д'БсюВTxНВ»!Z04ИГTюВT!Z05ВT:\0юВц!  "Г:]0·Ке!  НГс*ЦН*V0"Ц:O0·А*X0~юДґ*X06ЇН'Ї<ЙНm:Њ/ю ВХ:g0·К! "R0"P0НфНЉГХНкК Н·КBюДў>Н>#НGНк*I0Н!  "ГГХНфН:0юВ :Z0·В !0Nл*K0:O0·Вџ"b0+"X0y·К›ХЕН'БСГ‰ЇН'Г	НфНІ	ю>КБН®Г	ю	ИюИюИюЙ2КЇ2Л2М:0юВс:	0юВбНГчю!КчюВсН®Г-НГЛН:0юМ:0юВЛН!К4	Н:0юВ&	:	0ю:ВЛН:0юВЛН!ВЛюВЛxюВI	!Л4МЁГЛюВe	:Л·ВЛ:КюМ®>Нћ	Г	юВ}	!Л~5·ВЛ:М·Д®Г	НµВЌ	!М4МЁГЛюВЛ!М~5·ВЛГ G!Н~юТЁ4_ !ОpЙ!Н~·К®5^ !О~Й>ГЛ	>2\0НфН:0юВN
*K0"Е+"X0:0юЪр	>ЖН'ЇН'Н!Н:0юВN
:	0ю,ВN
Н:0·В
НГ>
НК>
!0N#~ЕеН'бБВ)
>Н'НЇН'*K0"V0:\0Гx
Нґ:\0Н"Г	Нmе}*K0"Е+"X0Н'сН'*K0"V0>Н"К4Н¬Н:Н2T/:[0ю
В“
Ї2/Н-*M0"$/*X0л!Е{–#zћлЪї
~+"X0*M0+"M0wГџ
#"K0*M0"ґ. :\0юКЭ
N ]T	лs#r+е*V0л*Е{•_zњWб"Ф.:\02¤.ГRГГГГНфННК%Н*I0:Њ/ю ВХНЄ%ГХН¬:O0·Д­%ГХГ Г:Ј.·КўН:0юВў*K0е+"X0Н!Ї2Ы<20*Ю#"Ю"ЬН:
0ю0ДЁ!??"	0Н9б"K0+"X0Н$Н<ННКХ:0юВў:	0ю,К?НґГХГНф*Ц}ґВъ:]0·ВъН:O0·В	:0юВъН¤%:e0·Д­%Н:0юВЩ:	0юКсюВЩН¬Н§%ГvНґГХГГНєНГХ:0юА:	0юИю!Ию;ЙЦю*Т _ !5^#fkйS\hn‚‹љЄіВЛТЩипН2НГыН Н»НµГыН ГыН–ю8К{жД‚yж0°ГшН2НµГыН–°GН»Н‹°ГшН–°Н1Н»НЇГыН2НЇГыН–ж(Д‚yж°ГшН2НµГыН‹°ГшН–°ГшН–жД‚yж0°ГшН–°ГшН2НЇГыН1НфНгГХ'иd 
  !^#V#е*Ь0}“o|љgЪ*Г"Ь:Ы·КDx=КDyю0КPЇ2Ы!0^4 !	0qбВЙ:0юД–:	0ю,Ию;ИюД–ЙЕНН*I0БЙНm|·}И$В†·шНЊoЙНyюФЊжЙН‹ж8OЙН–жД‚yж0°Г1НyГ1НmГXхЕ:0юВН:	0ю,КТ>CН%БсЙНф:0юВ :	0юВоНГvю;ВНфН:0юВц:	0ю
КvюК-ю!КvГцю!КvюК-НґГц{•ozњgЙ:Ј.·К7Н®Ї2Z0!O0~4·Вl!яя"Ш*Ц|µК>"V0еНге*ШНб"Шб"ЦГJННЉ!‘/6!Ќ/Н’%:^0·КЏ>2¤.НЎ%Н±*K0л*T0Н&е*M0л*T0Н&\ бН	лНЌ!‘/А·КОw#ГµH USE FACTOR !Ћ/Н’%*З"P0Гћ%zјА{ЅЙ*P0"R0Й*Г"V0Н	ЙНкИ!  "Г:O0·ВНхжДўсцН*R0НЙНжМњНл*R0НЭДњЙGЕ:O0·xД›%:Ќ/ю *R0МЌ:ЙюБxЬz*P0#"P0ЙеEН2бDГ2Ж0ю:ШЖЙНb!Й^ 4!Њ/wЙхжНjсжГj*R0л!Йе6zХНzС{Нzб4ЙЦAю_ШЖAю?ИЙЇ2Ґ.2Й*T0"V0!¬.8Їw#ВД*V0л*K0{•zњТ¤*b0НЭ+"X0КэНюВН·Кэ=хН$сГрН*·Вэ*X0#Гћ!¤.ѕВђ*V0"Є.#"X0Н$:d0·В<:0юЪ<!	0~ю?В<#ѕКђ:	0НЎ!¬. "Ё.^#Vл"V0}ґК{##~ж<O0F#ѕЪ{ВuК{Вc*V0ГI*V0л*Є."V0s#r+л*Ё.s#r*V0##~жЖ_ "V0ГК!¬."Ё.>2§.*Ё.^#V#"Ё.л"V0*V0}ґКd##~ж<2¦.G*V0##"X0:Ґ.·Къ>	Нu!Ґ.~жшЖwжКъ>†w>	Нu:Ґ.ЂЖюPЪ'!Й5^ !Њ/~ю	К!Й~6 20Н•%Ї2Ґ.Не|Нzб}Нz> Нu!Ґ.~Жw:¦.·КW=хН*Нu!Ґ.4сГC*V0^#Vл"V0ГЅ!§.5ВЇ:Й20Н•%Й!Й^ 4!Њ/wЙхЕ>RН%БсЙхе>VН%бсЙх>DГЅх>PГЅх>LГЅх>OГЅх>BГЅх>SГЅх>NН%сЙ                                  *вНЭА6 Й"ф.~юА6 Й      шГ Г-ГГи                                       л!2~юЪBНд6 ~44O !!	s#rЙх!1~ю
Ъ_6 Нд^ 4с!w!pЙ!2~·В~Нд!  Й55N !!	N#fiЙНoлНoЙo& )Ў^#fkй9BIO[ovЂЏ›Ёґ»ВЪбнщдНЊz·ВЧ{юШНд>ЙЇ•o> њgЙНЊл"!6  ЕЇ{_zW5бИ> О )D…*•OxњGЕТ	г!?Гц   DM!  ЇxGyOЪ2°ИГ3л)лГ#НЊНГНелГНеГНЛ·К)=ГRНЛ·КхЇ|g}oс=Г^НЊГНЊлНЭГrНoНЭГzјА{ЅЙНЊН‰ВФГОНЊ}“|љЪОГФНЊН‰КОГћНЊлГћНЊлГ«НЊН‰ВОГФ!яяГ!  ГНo#ГѓНЊz¤g{ҐoГНЊzґg{µoГНЊz¬g{­oГНolГНo& Г3:0юА:	0юИю;Ию!ЙНИю,ЙЇ2122=2!  "I0Н&Вq!1~·К\5_ !~Н”ГD:2юДд:Њ/ю А*!"I0Й:Њ/ю ВР:0юВќ:0·МдюФд !	0^#=К™VлГНюВЁ*0ГНН!ВЌюТ‚юВсННКи:0юВЩ:0·ВЩНН&КиННВЩ!  Гл!яяНЦГ>юO:В·Мд>я2yГU·В`Е:1·К0_ !~ёЪ0!1s!~Н”БГБyюВU!1~·КN=w_ !~юКQНдЇГZНP>я2ГРyюКРюВp<OГюКюКюДдГюМдh& ГН:0юВ¬:	0ю$К¦Нд!  ГН*R0ГННН	ВА>PН%НГКНж>UМ%ННЦНГ>:·МдЇ2Г3е>EН%бЙ                    Г ГсГіГfГь       :Ј.·КO*ф.~·ВH:¤.юК=!4> АНзН•%Н0:/·АГ#"ф.ГШ Н†%2G:0юxИюaШю{Рж_ЙхюК‡ю
К‡:0юxТ‡_ <20!Њ/сwЙсЙ:e/НSА:e/Н9ЙЇ2f/2d/Н2e/:0юИ:e/юЂЪЖН!2f/g/~#В»ГеНSИН‰Кр!f/~юТо4!g/_ :e/wН2e/ГКЇЙЇ<Й*V0"Н3Н6А*"V0ЙЇ2!4ВНЫ!f/6 "ф.!f/~·К55!d/^4 !g/~Гf:Ј.·:e/ВJG·ВwНГf·Кю^ВlН—^В{:e/ю&В{!f/4#wГwю&КћGюК±Ї2e/xГfН—К:e/ю&К•:0юКНуКГЅН—&К{Ну&К{ГЅН—КНуК!e/~ю&ВИ>6 2/Н-!¤.6*M0"$/НB"ф.Ї2f/*"V0Н—ГН2f/2e/2[020>
2Н•%>20ЙЇ202Й!0~ю@Ъ$6 НЫ^ 4#:[0wЙ~ю$АЇwЙ:[0Ц0ю
жЙН6А:[0ЦAюжЙ:[0ю?Кeю@КeЦAюжЙ·ЙНPАН6Йю Рю	ИюИю
ИюИГбННo2[0:Z0·К¦:\0юВ :O0·В¦:[0Н':[0ЙюИюИю!ЙНЇ20:[0ю	КRю;В/>20:Z0·К?:\0юВв:O0·В?НЃю;ВB*`0л*X0++{ЅВэzјК~ю
В++Гю!Т+Гу"X0:Z0хЇ2Z0НЃНЄВН'с2Z0ГX:[0ю*ВK:ю
ВKНЃНЄКXГ?ц ю ВXНЃГ¶Ї20НPКg>ГЈН6Кr>ГЈ:[0ю'ВѓЇ2[0>ГЈю
ВЎ:Ј.·К”>+2‘/Н•%!Њ/6 >20>20:[02·ДНЃ:0юВ:Z0·А:	0ю=ВО!EQГщю<Вд!LT:[0ю=Вщ!LEГхю>А!GT:[0ю=Вщ!GEЇ2[0"	0!04>20Й![0:0юВН/К¦НgВ¦ЙюВґН/К¦НAВ¦:[0юOК<юQВA>ГHюHВR>2Ї2[0Гm:юBВ_>ГfюD>
Вj!052!  "0!0N#~#юAТ„Ц0Г†Ц7еЕO!ѕФХ ~*0л!  ·К©ТЈл)лГљ	"0БбВxЙ:[0юКЫю'В¦НЃю'АГ¦:[0·Ию Ию	Й:[0ю,Ию;Ию%И:[0юИюИю!Й:[0ю;Ию Ию	Ию,ЙНЇ202НКВНЃГНХВ/>20ГЙ:[02НЃ:0юИНбВG:0юМХ:·ДХГП:0юВl:[0ю'ВЙННЃ:[0ю'К Ї20Г/:[0ю'В|>20ГЙю^В—НЃ:[0ю	КЙю ТЙНбГПю<ВЁ!~4·К ГЙю>Вј!~·КЙ5К ГЙ:·ВЙНнКПНГ >20Йх>VГнх>OГнх>IГнх>BГнЕеН%бБсЙсЙ        Г !ГQГ©Г‰ГГ Г$ Г? ГH ГY Г` Гe Г’ Гј ГІ Г~ГЕГЏГGГ‡ГҐГ»ГрГшГГfD?І<=З=Ў:  e>  ?; >  <>‰; <Y=2=>и;ъ<    ·=  R>Ь>е>    F>Ь;  њ>G=        “=Ж<=  ®=‘>ѕ=        s;Ґ=P=      *>=$?P:-?]>*<<  Ѓ=Љ=  е<я;  њ=Ѓ>‰>y>
<U<ю:?<k<Э:ф;      Ж>      	;и:=“;ы>?    о>P?  Є<щ=?І>ј>п=  Ы<С<  i;            m=>    c=е=Ё>o>v<Ы=ј<Ё;8?N!NЂЇw#w#ВW!  "V0Й!ѓ.Їw#w#ВlЙНж2NЙ!Ј.~юТ4^ !¤.~w!Ф.Нј!ґ.Нј!ф.Нј!/~w!$/Нј!D/~w!T/~wЙN#Fp+qЙ!Ј.~·Ке^ !¤.Н!Ф.Н
!ґ.Н
!ф.Н
!/Н!$/Н
!D/Н!T/Нб5Йе~бwЙеN#Fбq#pЙ>BГ%!0"Ц *Ц FЇ#†В%ж2NЙG*V0##~жр°wЙ*V0##~ж<ЙН‰Ил  :¤.юКt!Ј.N !¤.	y·Кq~юКt+Гa<лЙ!$/		{–z#ћЪ‰!  "V0ЇЙ*V0}ґЙ!f/"Ц Н :Nж2N!ѓ."OГёН!N"O!0"Ц *Ц ~юЪГ6!N^ *O^#fk"V0Н‰ИН=*Ц ѕВшG#л*V0###ѕВш#ВмЙ*V0^#VлГТ!0^ *K0"V0 л*M0{•zњлТу"K0!N"OН1Ї#w#wЙ*V0л!NN *O		N#Fr+sлq#p0юЪU>G=#w#wВYЙ*M0л!0n& 	{•ozњg"V0л!K0{–#zћЪул"M0Й Нb*M0л!0N#y·Кў~Г•ЇЙ Нb!ѓ."OН1:NН Й*M0л!$/{–#zћРл"V0Н$ _ !ѓ.л*V0~#~Н1 ~·#Вд"M0Г»Г1 !ьН’%Гћ%SYMBOL TABLE OVERFLOWжрG*V0##~ж°wЙ*V0##~жЙН=*V0_ ###ЙеН1 Сs#rЙН1 ^#VлЙН1 ##"X0ЙхНP сwЙНP ~ЙНж‡‡‡‡O!0~юЪz 6~=±Нј !0N#~ЕеНј бБВ„ ЙНІ Oж2Nyж<O0НІ ВЁ Й*X0#"X0~ЙЙO*X0#л*M0{•zњТул"X0q#"K0Йл"ю,ВR"вГR             Ъ–К–ГЂ      Г &ГЂ#Г$Гb$Г{$ь*!:!X!э!M"p"‚"€"Ё"Ж"4#\#j#()*+,-/ABCDEHLMDBDIDSDWEIEQGEGTIFINLELTNEORSPACIADCADDADIANAANDANICMACMCCMPCPIDAADADDCRDCXENDEQUHLTINRINXIRPJMPLDALOWLXIMODMOVMVINOPNOTNULORAORGORIOUTPOPPSWRALRARRETRLCRRCRSTSBBSBISETSHLSHRSTASTCSUBSUIXORXRAXRIASEGCALLCSEGDSEGELSEENDMHIGHIRPCLDAXLHLDNAMEPAGEPCHLPUSHREPTSHLDSPHLSTAXXCHGXTHLENDIFEXITMEXTRNLOCALMACROSTKLNTITLEINPAGEMACLIBPUBLIC7
 PF
FP уыAAA*Ы
A	AA(#О&€&Ђ#Ж& 2#ж/?&ё#ю'	'(v'( Г%:P!@" < &°
#ц*УБЙ)З&#ЮPP%27&ђ#Ц(&Ё#о Н$
%*йЕ%"щ$лг	NZZ NCC POPEP M я ЇxЃ»КБ#_еХЕеBH !  В™#С	0ѕ#Ві#ВЈ#БСб{ЙБСбЪЅ#KГ…#CГ…#Ї<Й:	0 ВюJИДюCИАюRЙ:0юТ
$юКп#юВ
$!06  p#!
0ѕВ$#ѕИВх#ЙЇ<Й:0O=_ ХюТ^$!‚"F!!V#fjQНЂ#ВG$2!С!!^#Vo& )ЇO~#FЙСНД#АЕНШ#xБА·°GyїЙСЇ<Й!0N!ѓ"ЇКt$†#Гk$!!†цЂЙж!™$_ ^#~жG~жW!:!xЙ      
          0!0$0'0*0-000306090<0?0B0E0H0K0N0Q0T0W0Z0]0`0c0f0i0l0o0r0u0x0{0~0Ѓ0„0‡0Љ0Ќ0ђ0“0–0™0њ0џ0ў0Ґ0Ё0«0®0±0ґ0·0є0Ѕ0А0Г@З@Л@П@У@Ч@Ы@Я@г@з@л@п@у@ч@ы@я@AAAAQQQ"Q'Q,Q1Q6a<aBaX0"ЅНГWz{|}ЇO~#FЙyїЙSEAR Гц&Г)ГL)Г*Г•*ГЙ*Гx&Гt+Г!,ГЈ-Г‹,ГI,ГЎ&Гб&ГM+Гщ*Ђ               7Г Ђ ГВ%!I%ѕИw_Н Й:JASM PE ГН%:L%ГН%:M%ГН%:    НI*~#юяPRN FTYPE яяяяяяяяяяяяs   яяя   яяяяяHEX яя&FTYPE яяяяяяяяяя   яяГ Ђ ГB&!Й%ѕИw_Н Й:К%ГM&:Л%ГM&:М%ГM&:Н%ГM&:О%ГM&~НЙ*~#юВx&>
НЙ*Й\ 	ю?К=)ю$К=)w#ВЋ&Й!\ 6 0ю	Ъ±&>GO#wВі&>ђO#КК&6 ГА&6L#6I#6B#Їw2| Нr&\ Гu'>я2]0!Ђ "Р%![0~2П%ЇwЙНG&!У,Нx&>82і%Ї2ґ%!  "b0* "M0! 1"ц% "& "@& #"K0"T0Гк'ю ИЕе_Н бБЙ#~Н6'ВD'Йел:Й%ЖAН6'>:Н6'НD'>.Н6'НD'>-Н6'бГx&ХН юяСА!и,НN'Г  ХН юяСА!k-Нx&Г  Г ХН юяСА!я,НN'Г  :Л%юИюИюЙю	ВТ'> НТ':Т%жВД'Йх_Н с!Т%ю
Ве'6 Йю Ш4ЙЇ2Т%2]02e02d02g02µ%:\ ю К=)Н !Й%w#w#w#w#w#w#>2^02_0:m ю$ВИ(!Ѓ ~#ю$В,(~·КИ(#ю К3(К%юAК©(юPК©(юSК©(юHК©(юLК©(ю*Кt(ю+Кt( ю-В¶(^0~юSКЈ(юMКЈ(e0юLКЈ(d0юQКЈ(g0юRКЈ(µ%ю1В¶(x#Г3(~ЦAюТ¶(#Г3(#6!)-Нx&!Ѓ Нx&Г  !У%Н‰&!ш%еН‰&бНі'Кй(ееН`&СН›'СН ':Н%юК)!&ееН‰&Нl&СН›'СН 'Й!°%60#60#60#>я2f0!  "&:O0·Дщ*! "ф%Ї2Я%2у%2ё%НZ&У%Нu'Й!-Нx&Г  zјА{ЅЙЕХе:]0·Кў)*Р%Ђ НF)Вw)!  "Р%Нr&\ Н ·В‰)*Р%#"Р%+Ђ ~юВя):Ј.·2]0Кў)Нr&\ !~-НN'Г  *ф% НF)Вр)НZ&!  "ф%*ц%ЕелНB&У%Н бЂ Б·ВЫ)Вј)Гн)юТ*Кн)Ђ6#Вж)НG&*ц%л*ф%е#"ф%б~бСБжЙ!<-Нx&Г  ЕG:Л%юК7*юВ$*xНЙ*Г7*ХеюxВ2*Нї'Г5*Н9*бСБЙ*&л*&wл#"&л! НF)АН`&!  "&*&ш%~юК…*ЕХелНB&бЂ СХеН бСБ·ВЊ*В`*НG&ЙГ`*!S-Нx&Г¶,ЕХеНџ*бСБЙ*>&л*@&wл#">&л! НF)АНl&!  ">&*@&&Г`*ЕХе_Н бСБЙ!І%~<wю:Ък*60+ВЫ*!°%~Н*#Вп*Й:і%·И>Н*Ї2ґ%*b0}ґИ!У,~юК+Н*#Г+>	Н*>#Н*НЦ*>	Н**b0~·К>+Н*#Г2+>Н*>
Н*>
Г*}2і%!ґ%–РГщ*OН*:Њ/ю И:O0юИ:Л%юИyНЙ*Й:µ%!O0¶В•+:e0!]0¦Вг+~·К,:Њ/ю К,!Њ/~ю Вг+:f0·К,:‘/ю+Вг+:_0·К,юКг+:’/ю#К,:Ќ/ю К,:_0=Кг+ !Њ/~ю КУ+!0s!ґ%е~!і%–Фщ*б4:0!Њ/·К,G~НY+#x=Гч+>НY+>
НY+Ї20!Њ/>x6 #=В,ЙG!Њ/~ю АpЙНі'И*&}ґК?,>Н*Г/,Н`&ш%Н€'Й:^0юКщ*Н+,!&6S#6Y#6M#Їw!&w:М%2Л%!  "&Ні'Кщ*Ї2і%Н`&ш%ХН›'СН 'ЙН+,:Н%юК¶,:ё%·Д.*P0"¶%Н.*>&}ґК¶,>Н•*Г¦,Н+,:Н%юКК,Нl&&Н€'!“-Нx&Г  CP/M MACRO ASSEM 2.0NO SOURCE FILE PRESENTNO DIRECTORY SPACESOURCE FILE NAME ERRORINVALID PARAMETER:SOURCE FILE READ ERROROUTPUT FILE WRITE ERRORCANNOT CLOSE FILESUNBALANCED MACRO LIBEND OF ASSEMBLYЕG:Н%юxКп-Хх!ё%~·КЫ-юЪГ-Н.ГЫ-*P0л*¶%O 	{ЅВШ-zјКб-Н.*P0"¶%!ё%^4 !№%сwСБЙхжН.схжН.с‚WЙЖђ'О@'Г•*>:Н•*!ё%^ЇWw*¶%{Нс-|Нс-}Нс-ЇНс-{·К?.!№%~#Нс-В6.Ї’Нс->Н•*>
Н•*ЙНћ*>
Нћ*Йчяяяяяяпяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяwчяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяsчяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяяя                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ;******************************************************************************
;******************************************************************************
;		BIOS21I				VERSION 820505/1200|RACIII/JCM
;------------------------------------------------------------------------------
;				SUPPORTING
;	DRIVE NAME	DENSITY		CONTROLLER	BASE ADDRESS
;	----------	-------		----------	------------
;	A:, B:		DOUBLE		202		78H
;	C:, D:		SINGLE		201		88H
;	E:		SINGLE		IOC		C0H
;------------------------------------------------------------------------------
;	COPYRIGHT (C) 1978, 1979	|	COPYRIGHT (C) 1982
;	DIGITAL RESEARCH		|	INTEL CORP.
;	BOX 579, PACIFIC GROVE		|	3065 BOWERS AVENUE
;	CALIFORNIA, 93950		|	SANTA CLARA, CALIFORNIA 95051
;******************************************************************************
;******************************************************************************


;******************** EQUATES *************************************************

	MACLIB	DISKDEF

VERS	EQU	22		; CP/M VERSION 2.2
FALSE	EQU	0
TRUE	EQU	NOT FALSE

RELOC	EQU	FALSE

	IF NOT RELOC
MSIZE	EQU	62		; MEMORY SIZE IN KILOBYTES
RAM$TOP	EQU	MSIZE*1024	; TOP ADDRESS+1
BIOS	EQU	RAM$TOP-800H	; BASIC INPUT/OUTPUT SYSTEM
BDOS	EQU	BIOS-0E00H	; BASE OF THE BDOS
CCP	EQU	BDOS-0800H	; THE CONSOLE COMMAND PROCESSOR
	ORG	BIOS
	ENDIF

	IF RELOC
	ORG	0		; OR 0100H FOR REL-1
CCP	EQU	$
BDOS	EQU	CCP+0800H
BIOS	EQU	BDOS+0E00H
MSIZE	EQU	0		; DUMMY FOR SIGN-ON MESSAGE
	ORG	0800H+0E00H	; PLUS ANOTHER 0100H FOR REL-1
	ENDIF


CPML	EQU	BIOS-CCP
NSECTS	EQU	CPML/128	; NUMBER OF SECTORS TO LOAD

CDISK	EQU	0004H		; ADDRESS OF LAST LOGGED DISK ON WARM START
BUFF	EQU	0080H		; DEFAULT BUFFER ADDRESS

IOBYTE	EQU	0003H		; ADDRESS OF IO BYTE FOR MONITOR
IOBYTI	EQU	0081H		; Initial value for IOBYTE

INT$CONT$1	EQU	0FDH	; INTERRUPT PRIORITY RESTORE PORT
INT$CONT$0	EQU	0FCH	; INTERRUPT MASK PORT
MON$INT		EQU	0F3H	; INTERRUPT CONTROL PORT
INT$MASK	EQU	0111$1110B	; ENABLE RST 0(WBOOT), RST 7 (MONITOR)

;	MDS MONITOR EQUATES

MON80	EQU	0F800H
RMON80	EQU	0FF0FH		; RESTART MON80 (BOOT ERROR)
CI	EQU	0F803H
CO	EQU	0F809H
CSTS	EQU	0F812H
RI	EQU	0F806H
PO	EQU	0F80CH
LO	EQU	0F80FH

CR	EQU	0DH		; CARRIAGE RETURN
LF	EQU	0AH		; LINE FEED

;*************** DISK EQUATES *************************************************

RETRY	EQU	10		; MAX RETRIES ON DISK I/O BEFORE ERROR
NUM$DISKS	EQU	5	; NUMBER OF DRIVES AVAILABLE

;*************** 202 CONTROLLER EQUATES ***************************************

BASE2	EQU	78H		; BASE OF DISK COMMAND IO PORTS
DSTAT2	EQU	BASE2		; DISK STATUS (INPUT)
RTYPE2	EQU	BASE2+1		; RESULT TYPE (INPUT)
RBYTE2	EQU	BASE2+3		; RESULT BYTE (INPUT)

ILOW2	EQU	BASE2+1		; IOPB LOW ADDRESS (OUTPUT)
IHIGH2	EQU	BASE2+2		; IOPB HIGH ADDRESS (OUTPUT)

READF	EQU	4H		; READ FUNCTION
WRITF	EQU	6H		; WRITE FUNCTION
RECAL	EQU	3H		; RECALIBRATE DRIVE
IORDY	EQU	4H		; I/O FINISHED MASK

;*************** 201 CONTROLLER EQUATES ***************************************

BASE	EQU	88H		; BASE OF DISK COMMAND IO PORTS
DSTAT	EQU	BASE		; DISK STATUS (INPUT)
RTYPE	EQU	BASE+1		; RESULT TYPE (INPUT)
RBYTE	EQU	BASE+3		; RESULT BYTE (INPUT)

ILOW	EQU	BASE+1		; IOPB LOW ADDRESS (OUTPUT)
IHIGH	EQU	BASE+2		; IOPB HIGH ADDRESS (OUTPUT)

READF	EQU	4H		; READ FUNCTION
WRITF	EQU	6H		; WRITE FUNCTION
RECAL	EQU	3H		; RECALIBRATE DRIVE
IORDY	EQU	4H		; I/O FINISHED MASK

;*************** IOC CONTROLLER EQUATES ***************************************

;*** IOC COMMANDS ***
RDSTAT	EQU	00011B		; READ DEVICE STATUS
WPBC	EQU	10101B		; WRITE FIRST BYTE OF PBC
WPBCC	EQU	10110B		; WRITE NEXT BYTE OF PBC (5 BYTES TOTAL)
WDBC	EQU	10111B		; WRITE DISKETTE DATA BYTES
RDBC	EQU	11001B		; READ DISKETE DATA BYTES
RRSTS	EQU	11011B		; READ DISKETTE RESULT BYTE
RDSTS	EQU	11100B		; READ DISKETTE STATUS BYTE

;**** I/O PORTS ****
IOCDATA	EQU	0C0H		; DATA PORT
IOCCNTR	EQU	0C1H		; CONTROL PORT

	;**** DISK RESULT BYTE ****
SEEKERR	EQU	0000100B	; SEEK ERROR

	;**** DBB STATUS BYTE ****
OBF	EQU	1B		; OUTPUT BUFFER FULL
IBF	EQU	10B		; INPUT BUFFER FULL
F0	EQU	100B		; COMMAND STATUS FLAG (ON=ACCEPTED OFF=COMPLETED)
CD	EQU	1000B		; COMMAND/DATA FLAG (ON=STATUS OFF=DATA)


	;**** DISKETTE STATUS BYTE FLAGS ****
READY	EQU	1B		; ON=DEVICE IS READY
OPCOMP	EQU	100B		; OPERATION COMPLETED
PRESENT	EQU	1000B		; DEVICE IS PHISICALLY PRESENT
ILLDATA	EQU	100000B		; ILLEGAL DATA SENT
ILLSTAT	EQU	1000000B	; ILLEGAL INTERUPT REQUEST

;**** DEVICE STATUS BYTE ****
DSKERR	EQU	10000000B	; DISK ERROR FLAG

;**** UNIQUE DISKETTE OPERATION CODES ****
RECALB	EQU	011B		; RECALIBRATE DISK


;******************************************************************************
;		JUMP VECTOR FOR INDIVIUAL ROUTINES
;******************************************************************************

	JMP	BOOT
WBOOTE:	JMP	WBOOT
	JMP	CONSTAT
	JMP	CONIN
	JMP	CONOUT
	JMP	LIST
	JMP	PUNCH
	JMP	READER
	JMP	HOME
	JMP	SELDSK
	JMP	SETTRK
	JMP	SETSEC
	JMP	SETDMA
	JMP	READ
	JMP	WRITE
	JMP	LIST$ST		; LIST STATUS POLL
	JMP	SECT$TRAN	; SECTOR TRANSLATION

;******************************************************************************
;		CODE SECTION
;******************************************************************************

BOOT:	LXI	SP,BUFF+80H	; TEMPORARY STACK POINTER
				; SET UP INTERRUPTS FOR 0 AND 7 ENABLED
	DI
	MVI	A,12H		; GIVE NON-EXISTANT I8259 INTERRUPT CONTROLLER
	OUT	INT$CONT$1	 ; IT'S INTIALIZATION SEQUENCE
	XRA	A
	OUT	INT$CONT$0	; THIS ACTUALLY ALLOWS PENDING INTERRUPTS
				;  ON TO HAPPEN, BUT INTEL SEZ
				;  DO IT TO IT FOR THE I8259 COMPATIBILITY

	MVI	A,INT$MASK	; RST0 AND RST7 BITS ON
	OUT	INT$CONT$0
	XRA	A
	OUT	MON$INT		; MASK ALL MONITOR BOARD INTERRUPTS

;	PLUG ALL UNUSED INTERRUPT VECTORS WITH RST 7
;	SO UNEXPECTED INTERRUPTS WILL BREAKPOINT TO MDSMON


	LXI	H,00008H	; POINT TO RESTART 1 LOCATION
	MOV	D,H		; KEEP VALUE 8 FOR INCREMENT
	MOV	E,L		;
	MVI	C,6		; WE WANT TO INIT. SIX RESTARTS
FILL$LOOP:
	MVI	M,0FFH		; PLUG IN A RESTART 7 INSTR.
	DAD	D		; POINT TO NEXT RESTART LOCATION
	DCR	C		; DROP COUNT
	JNZ	FILL$LOOP	; AND ITERATE

	LDA	5		; GET MDSMON'S LOCATION 5 TO SAVE
	STA	HOLD$5		; FOR COMPATIBILITY WITH MDS230

	XRA	A		; CLEAR ACCUMULATOR
	STA	CDISK		; SET INITIALLY TO DISK A/USER 0

	LXI	H,SIGN$ON	;
	CALL	PRMSG		;
	JMP	GOCPM		; GO TO CP/M


WBOOT:
	LXI	SP,0100H	 ; TEMP STACK POINTER
WBOOT0:
	LXI	B,CCP		; SET DMA ADDRESS TO START OF DISK SYSTEM
	CALL	SETDMA

	MVI	C,0		; BOOT FROM DRIVE 0
	CALL	SELDSK
	CALL	HOME

	MVI	C,2		; START READING SECTOR 2
	CALL	SETSEC

;	READ MULTIPLE SECTORS, COUNT NSECTS TO ZERO
;* IF NSECTS EVER GETS LARGER THAN 51 THAN THIS BOOT NEEDS TO
;* BE MODIFIED.
	MVI	A,NSECTS
	STA	ION		; SAVE IN IOPB
	CALL	READ		; DO READ
	JNZ	WBOOT		; REPEAT IF ERROR
	MVI	A,1		; SET NUMBER OF SECTORS TO 1 
	STA	ION		; FOR REST OF WORLD


;
GOCPM:	;(ENTER HERE FROM COLD START BOOT)

;	SET UP PAGE ZERO JUMPS TO WARM BOOT, BDOS, AND MDSMON BREAKPOINT

	MVI	A,JMP
	STA	0
	LXI	H,WBOOTE
	SHLD	1		; JMP WBOOT AT LOCATION 00
	STA	5
	LXI	H,BDOS+6
	SHLD	6		; JMP BDOS AT LOCATION 5
	STA	7*8		; JMP TO MON80 (MAY HAVE BEEN CHANGED BY DDT)
	LXI	H,RMON80
	SHLD	7*8+1

; Set I/O byte

	MVI	A,IOBYTI	; Initial value for IOBYTE
	STA	IOBYTE		; ***

	LDA	CDISK		; LAST LOGGED DISK NUMBER
	MOV	C,A		; SEND TO CCP TO LOG IT IN

	EI
	JMP	CCP

CONIN:
	CALL	CI1
	ANI	7FH
	RET
CI1:
	CALL	MON
	DB	0FFH AND CI
CONOUT:
	CALL	MON
	DB	0FFH AND CO
CONSTAT:
	CALL	MON
	DB	0FFH AND CSTS
LIST:
	CALL	MON
	DB	0FFH AND LO
READER:
	CALL	MON
	DB	0FFH AND RI
PUNCH:
	CALL	MON
	DB	0FFH AND PO
MON:				; PATCH FOR LOC. 5
	LXI	H,00005H	; RESTORE MDS LOC. 5
	LDA	HOLD$5		;
	MOV	M,A		;
	XTHL			; FETCH & BUILD MON CALL ADDRESS
	MOV	L,M		;
	MVI	H,0F8H		;
	CALL	CALLER		; VECTOR TO APPROPRITIATE MDSMON ENTRY
	POP	H		; RESTORE CP/M'S BDOS VECTOR OPCODE
	MVI	M,0C3H		;
	RET			;

CALLER:	PCHL

LIST$ST:XRA	A		; NOT IMPLEMENTED
	RET			;

SELDSK:				;SELECT DISK GIVEN BY REGISTER C
	LXI	H,0000		; FIRST, INSURE GOOD SELECT
	MOV	A,C		;
	CPI	NUM$DISKS	;
	RNC			;
	LXI	H,SEL$TABLE	;
	MVI	B,0		;
	DAD	B		;
	MOV	A,M		;
	STA	IOF		;
	STA	IOFSV		; SAVE DRIVE ADDRESS
	MOV	H,B		; GET DRIVE CODE TO [HL]
	MOV	L,C		;
	DAD	H		; MULTIPLY BY 16
	DAD	H		;
	DAD	H		;
	DAD	H		;
	LXI	D,DPBASE	; AND MAKE ADDRESS OF DRIVE TABLE
	DAD	D		;
	RET

HOME:				;MOVE TO HOME POSITION
	MVI	C,0
SETTRK:				;SET TRACK ADDRESS GIVEN BY C
	LXI	H,IOT
	MOV	M,C
	RET
;
SETSEC:				; SET SECTOR NUMBER GIVEN BY C
	MOV	A,C		; SECTOR NUMBER TO ACCUM
	STA	IOS		; STORE SECTOR NUMBER TO IOPB
	RET
;
SETDMA:				; SET DMA ADDRESS GIVEN BY REGS B,C
	MOV	L,C
	MOV	H,B
	SHLD	IOD
	RET

SECT$TRAN:			; TRANSLATE THE SECTOR # IN <C> IF NEEDED
	MOV	H,B		; IN CASE OF NO TRANSLATION
	MOV	L,C		;
	INX	H		;
	MOV	A,D		; (TRANTAB) = 0 , AND RETURN
	ORA	E		;
	RZ			;
	XCHG			; ELSE, OFFSET TABLE LOGICAL SECTOR
	DAD	B		;
	MOV	L,M		; THEN FETCH THE PHYSICAL SECTOR
	MVI	H,0		;
	RET

;******************************************************************************
;		DISK DRIVERS
;******************************************************************************

READ:	LDA	IOFSV		; CHOOSE WHICH DRIVER CODE TO USE
	MOV	C,A		; HOLD SELECT CODE
	ANI	040H		; TEST IF IOC SELECTED
	JNZ	READI		; YES - USE IOC DRIVER
	MOV	A,C		; RESTORE [A]
	ANI	020H		; TEST IF 201 SELECTED
	JNZ	READ1		; YES - USE 201 DRIVER
	JMP	READ2		; IF NONE OF THE ABOVE - USE 202 DRIVER

WRITE:	LDA	IOFSV		; CHOOSE WHICH DRIVER CODE TO USE
	MOV	C,A		; HOLD SELECT CODE
	ANI	040H		; TEST IF IOC SELECTED
	JNZ	WRITEI		; YES - USE IOC DRIVER
	MOV	A,C		; RESTORE [A]
	ANI	020H		; TEST IF 201 SELECTED
	JNZ	WRITE1		; YES - USE 201 DRIVER
	JMP	WRITE2		; IF NONE OF THE ABOVE - USE 202 DRIVER

;*************** 202 CONTROLLER DRIVER CODE ***********************************

READ2:				; READ NEXT DISK RECORD ( DISK/TRK/SEC/DMA SET)
	MVI	C,READF		; SET TO READ FUNCTION
	JMP	SETFUNC2

WRITE2:				; DISK WRITE FUNCTION
	MVI	C,WRITF

SETFUNC2:
;	SET FUNCTION FOR NEXT I/O (COMMAND IN REG-C)
	MVI	A,80H		; INITIALIZE IOPB FOR DUAL DENSITY 202
	STA	IOPB		;	*
	LXI	H,IOF		; IO FUNCTION ADDRESS
	MOV	A,M		; GET IT TO ACCUMULATOR FOR MASKING
	ANI	1111$1000B	; REMOVE PREVIOUS COMMAND
	ORA	C		; SET TO NEW COMMAND
	MOV	M,A		; REPLACED IN IOPB

WAITIO2:
	MVI	C,RETRY		; MAX RETRIES BEFORE PERM ERROR
REWAIT2:
;	START THE I/O FUNCTION AND WAIT FOR COMPLETION
	CALL	INTYPE2		; IN RTYPE
	CALL	INBYTE2		; CLEARS THE CONTROLLER

	MVI	A,IOPB AND 0FFH	; LOW ADDRESS FOR IOPB
	MVI	B,IOPB SHR 8	; HIGH ADDRESS FOR IOPB
	OUT	ILOW2		; LOW ADDRESS TO CONTROLLER
	MOV	A,B
	OUT	IHIGH2		; HIGH ADDRESS

WAIT02:	CALL	INSTAT2		; WAIT FOR COMPLETION
	ANI	IORDY		; READY?
	JZ	WAIT02

;	CHECK IO COMPLETION OK
	CALL	INTYPE2		; MUST BE IO COMPLETE (00) UNLINKED
;	00 UNLINKED I/O COMPLETE,    01 LINKED I/O COMPLETE (NOT USED)
;	10 DISK STATUS CHANGED       11 (NOT USED)

	CPI	10B		; READY STATUS CHANGE?
	JZ	WREADY2

;	MUST BE 00 IN THE ACCUMULATOR
	ORA	A
	JNZ	WERROR2		; SOME OTHER CONDITION, RETRY

;	CHECK I/O ERROR BITS
	CALL	INBYTE2
	RAL
	JC	WREADY2		; UNIT NOT READY
	RAR
	ANI	11111110B	; ANY OTHER ERRORS?  (DELETED DATA OK)
	JNZ	WERROR2

;	READ OR WRITE IS OK, ACCUMULATOR CONTAINS ZERO
	RET

WREADY2:				; NOT READY, TREAT AS ERROR FOR NOW
	CALL	INBYTE2		; CLEAR RESULT BYTE
	JMP	TRYCOUNT2

WERROR2:			; RETURN MALFUNCTION (CRC, TRACK, SEEK, ETC.)
;	THE MDS CONTROLLER HAS RETURNED A BIT IN EACH POSITION
;	OF THE ACCUMULATOR, CORRESPONDING TO THE CONDITIONS:
;	0	- DELETED DATA (ACCEPTED AS OK ABOVE)
;	1	- CRC ERROR
;	2	- SEEK ERROR
;	3	- ADDRESS ERROR (HARDWARE MALFUNCTION)
;	4	- DATA OVER/UNDER FLOW (HARDWARE MALFUNCTION)
;	5	- WRITE PROTECT (TREATED AS NOT READY)
;	6	- WRITE ERROR (HARDWARE MALFUNCTION)
;	7	- NOT READY
;	(ACCUMULATOR BITS ARE NUMBERED 7 6 5 4 3 2 1 0)

TRYCOUNT2:
;	REGISTER C CONTAINS RETRY COUNT, DECREMENT 'TIL ZERO
	DCR	C
	JNZ	REWAIT2		; FOR ANOTHER TRY

;	CANNOT RECOVER FROM ERROR
	MVI	A,1		; ERROR CODE
	RET

;	INTYPE, INBYTE, INSTAT READ DRIVE BANK 00 OR 10
INTYPE2:
	IN	RTYPE2
	RET

INBYTE2:
	IN	RBYTE2
	RET

INSTAT2:
	IN	DSTAT2
	RET
;*************** END 202 CODE ***

;*************** 201 CONTROLLER DRIVER ****************************************

READ1:				; READ NEXT DISK RECORD ( DISK/TRK/SEC/DMA SET)
	MVI	C,READF		; SET TO READ FUNCTION
	JMP	SETFUNC
;
WRITE1:				; DISK WRITE FUNCTION
	MVI	C,WRITF
;
SETFUNC:
;	SET FUNCTION FOR NEXT I/O (COMMAND IN REG-C)

	mvi	a,80h
	sta	iopb		; restore IOPB channel command	820504

	LXI	H,IOF		; IO FUNCTION ADDRESS
	MOV	A,M		; GET IT TO ACCUMULATOR FOR MASKING
	ANI	1111$1000B	;REMOVE PREVIOUS COMMAND
	ORA	C		; SET TO NEW COMMAND
	MOV	M,A		; REPLACED IN IOPB
;	SINGLE DENSITY DRIVE 1 REQUIRES BIT 5 ON IN SECTOR #
;	MASK THE BIT FROM THE CURRENT I/O FUNCTION
	ANI	0010$0000B	;MASK THE DISK SELECT BIT
	LXI	H,IOS		;ADDRESS THE SECTOR SELECT BYTE
	ORA	M		;SELECT PROPER DISK BANK
	MOV	M,A		;SET DISK SELECT BIT ON/OFF
;
WAITIO:
	MVI	C,RETRY		; MAX RETRIES BEFORE PERM ERROR
REWAIT:
;	START THE I/O FUNCTION AND WAIT FOR COMPLETION
	CALL	INTYPE		; IN RTYPE
	CALL	INBYTE		; CLEARS THE CONTROLLER

	MVI	A,IOPB AND 0FFH	; LOW ADDRESS FOR IOPB
	MVI	B,IOPB SHR 8	; HIGH ADDRESS FOR IOPB
	OUT	ILOW		; LOW ADDRESS TO CONTROLLER
	MOV	A,B
	OUT	IHIGH		; HIGH ADDRESS
	JMP	WAIT0		; TO WAIT FOR COMPLETE

WAIT0:	CALL	INSTAT		; WAIT FOR COMPLETION
	ANI	IORDY		; READY?
	JZ	WAIT0

;	CHECK IO COMPLETION OK
	CALL	INTYPE		; MUST BE IO COMPLETE (00) UNLINKED
;	00 UNLINKED I/O COMPLETE,    01 LINKED I/O COMPLETE (NOT USED)
;	10 DISK STATUS CHANGED       11 (NOT USED)
	CPI	10B		; READY STATUS CHANGE?
	JZ	WREADY

;	MUST BE 00 IN THE ACCUMULATOR
	ORA	A
	JNZ	WERROR		; SOME OTHER CONDITION, RETRY

;	CHECK I/O ERROR BITS
	CALL	INBYTE
	RAL
	JC	WREADY		; UNIT NOT READY
	RAR
	ANI	11111110B	; ANY OTHER ERRORS?  (DELETED DATA OK)
	JNZ	WERROR

;	READ OR WRITE IS OK, ACCUMULATOR CONTAINS ZERO
	RET

WREADY:				; NOT READY, TREAT AS ERROR FOR NOW
	CALL	INBYTE		; CLEAR RESULT BYTE
	JMP	TRYCOUNT

WERROR:				; RETURN MALFUNCTION (CRC, TRACK, SEEK, ETC.)
;	THE MDS CONTROLLER HAS RETURNED A BIT IN EACH POSITION
;	OF THE ACCUMULATOR, CORRESPONDING TO THE CONDITIONS:
;	0	- DELETED DATA (ACCEPTED AS OK ABOVE)
;	1	- CRC ERROR
;	2	- SEEK ERROR
;	3	- ADDRESS ERROR (HARDWARE MALFUNCTION)
;	4	- DATA OVER/UNDER FLOW (HARDWARE MALFUNCTION)
;	5	- WRITE PROTECT (TREATED AS NOT READY)
;	6	- WRITE ERROR (HARDWARE MALFUNCTION)
;	7	- NOT READY
;	(ACCUMULATOR BITS ARE NUMBERED 7 6 5 4 3 2 1 0)

TRYCOUNT:
;	REGISTER C CONTAINS RETRY COUNT, DECREMENT 'TIL ZERO
	DCR	C
	JNZ	REWAIT		; FOR ANOTHER TRY

;	CANNOT RECOVER FROM ERROR
	MVI	A,1		; ERROR CODE
	RET

INTYPE:	IN	RTYPE
	RET

INBYTE:	IN	RBYTE
	RET

INSTAT:	IN	DSTAT
	RET
;*************** END 201 CODE ***

;*************** IOC CONTROLLER DRIVER CODE ***********************************

READI:				; READ NEXT DISK RECORD ( DISK/TRK/SEC/DMA SET)
	MVI	C,READF		; SET TO READ FUNCTION
	JMP	SETFUNCI
;
WRITEI:				; DISK WRITE FUNCTION
	MVI	C,WRITF
;
SETFUNCI:
;	SET FUNCTION FOR NEXT I/O (COMMAND IN REG-C)
	MVI	A,80H		; INITIALIZE IOPB FOR DUAL DENSITY 202
	STA	IOPB		;	*
	LXI	H,IOF		; IO FUNCTION ADDRESS
	MOV	A,M		; GET IT TO ACCUMULATOR FOR MASKING
	ANI	1111$1000B	; REMOVE PREVIOUS COMMAND
	ORA	C		; SET TO NEW COMMAND
	MOV	M,A		; REPLACED IN IOPB

	LDA	IOFSV		; RESTORE DRIVE ADDRESS
	ANI	0100$0000B	; IOC ?
	JZ	WAITIO		; NO - CONTINUE WITH DUAL

;* VERIFY DISK IS READY *
	CALL	DISABLE		; DISABLE INTERRUPTS
SDSKSTAT:
	MVI	C,RETRY		; SET RETRY COUNT
SDSK1:
	CALL	DSKSTAT		; GET THE STATUS BYTE
	PUSH	PSW		; SAVE STATUS BYTE
	ANI	READY		; DISK READY ?
	JNZ	SDSKSOK		; YES ... NO ERROR
;				  NO ... TEST FOR MAX RETRIES
	DCR	C		; = MAX RETRIES?
	JZ	SDERROR		; YES ... REPORT ERROR
	POP	PSW
	JMP	SDSK1		; RETRY!

SDSKSOK:
	POP	PSW		; RESTORE STATUS BYTE
	ANI	OPCOMP		; ANY PENDING OPERATIONS ?
	JZ	BLDIOPB		; NO - GO BUILD THE CONTROL BLOCK
;* CLEAR ANY ACTIVITY ON THE DISK DRIVE *
	CALL	DSKRSLT		; GET THE RESULT BYTE 
	JMP	SDSKSTAT	; GO MAKE SURE IT IS CLEARED

;**** MODIFY CONTROL BLOCK TO IOC FORMAT ***
;* BYTE TWO - MODIFY OP CODE *
BLDIOPB:
;* BYTE 1
	MVI	A,0H		; SET FIRST BYTE TO 0
	STA	IOPB		;
	LDA	IOF		; PUT 202 OP CODE IN ACCUMULATOR
	ANI	0000$0111B	; ISOLATE OP CODE
	STA	IOF		; PUT BACK IN IOPB


	MVI	C,RETRY		; INITIALIZE RETRY COUNTER
;* DETERMINE IF READ OR WRITE *
	CPI	READF		; READ ?
	JZ	SDREAD		; YES - BRANCH


;*** BEGIN IOC WRITE ROUTINE ***
SDWRITE:
	CALL	DBBWAIT		; WAIT FOR IOC TO BE READY
	MVI	A,WDBC		; LOAD WRITE COMMAND
	OUT	IOCCNTR		; ISSUE COMMAND TO IOC
	CALL	DBBWAIT		; WAIT FOR IOC TO HANDLE COMMAND
	LDA	ION		; # OF SECTORS
	OUT	IOCDATA		; SEND TO IOC
	CALL	DBBWAIT		; WAIT FOR IOC TO HANDLE

;* PASS DATA TO IOC RAM *
	LHLD	IOD		; LOAD ADDRESS OF DATA
	LDA	ION		; LOAD NUMBER OF SECTORS
SDWLP1:
	PUSH	PSW		; SAVE SECTOR COUNT
	MVI	D,128		; INITIALIZE BYTE COUNT FOR SECTOR
SDWLP2:
	MOV	A,M		; PUT DATA IN ACCUMULATOR
	OUT	IOCDATA		; PASS TO IOC RAM
	CALL	OUTWAIT		; WAIT FOR IOC TO HANDLE
	INX	H		; BUMP CHARACTER POINTER
	DCR	D		; DECREMENT CHARACTER COUNTER
	JNZ	SDWLP2		; LOOP TILL SECTOR DONE
	POP	PSW		; LOAD SECTOR COUNT
	DCR	A		; DECREMENT
	JNZ	SDWLP1		; LOOP TILL END OF SECTORS
	CALL	OUTIOPB		; PASS IOPB TO IOC
	CALL	ENABLE		; ENABLE INTERRUPTS
	CALL	CKRESULT	; CHECK RESULTS OF WRITE
	ORA	A		; SET FLAGS
	RZ			; RETURN OF OK
	DCR	C		; OVER RETRY LIMIT ?
	JNZ	SDWRITE		; NO - TRY AGAIN
	MVI	A,1		; ELSE SET BAD RETURN CODE
	RET			; AND RETURN


;* IOC READ ROUTINE *

SDREAD:
	CALL	DBBWAIT		; WAIT FOR DBB TO BE READY
	CALL	OUTIOPB		; SEND IOPB TO IOC
	CALL	CKRESULT	; CHECK RESULT OF READ
	ORA	A		; SET FLAGS
	JZ	SDRDATA		; GET DATA IF OK
	DCR	C		; BEYOND RETRY LIMIT ?
	JNZ	SDREAD		; NO - TRY AGAIN
	CALL	ENABLE		; ENABLE THE INTERRUPTS
	MVI	A,1		; ELSE SET BAD RETURN CODE
	RET			; AND RETURN

;* GET THE DATA *
SDRDATA:
	CALL	DBBWAIT		; WAIT FOR IOC TO BE READY
	MVI	A,RDBC		; SET COMMAND TO GET THE DATA
	OUT	IOCCNTR		; SEND TO IOC
	LHLD	IOD		; LOAD DMA ADDRESS
	LDA	ION		; LOAD NUMBER OF SECTORS
SDRLP1:
	PUSH	PSW		; SAVE SECTOR COUNT
	MVI	D,128		; SET BYTES/SECTOR COUNT
SDRLP2:
	CALL	INWAIT		; WAIT FOR A BYTE TO BE READY
	IN	IOCDATA		; GET THE BYTE
	MOV	M,A		; MOVE TO BUFFER
	INX	H		; INCREMENT POINTER
	DCR	D		; DECREMENT CHARACTER COUNTER
	JNZ	SDRLP2		; LOOP THROUGH SECTOR
	POP	PSW		; LOAD SECTOR COUNTER
	DCR	A		; DECREMENT
	JNZ	SDRLP1		; LOOP THROUGH THE SECTORS
	CALL	ENABLE		; ENABLE INTERRUPTS AT END OF DATA
	MVI	A,0		; SET GOOD RETURN CODE
	RET			; RETURN


;* IOC SUBROUTINES *

;* PASS THE IOPB *
OUTIOPB:
	LXI	H,IOPB		; POINT AT IOPB
	MVI	D,5		; LOAD BYTE COUNTER
	MVI	A,WPBC		; LOAD COMMAND FOR IOC
	JMP	SDWPB		; GO ISSUE THE COMMAND
SDWPBL1:
	MVI	A,WPBCC		; LOAD COMMAND FOR IOC
SDWPB:
	OUT	IOCCNTR		; OUTPUT COMMAND TO IOC
	CALL	DBBWAIT		; WAIT FOR IOC TO HANDLE
	MOV	A,M		; PUT DATA IN ACCUMULATOR
	OUT	IOCDATA		; PASS TO IOC
	CALL	OUTWAIT		; WAIT FOR IOC TO HANDLE
	INX	H		; INCREMENT CHARACTER POINTER
	DCR	D		; DECREMENT CHARACTER COUNTER
	JNZ	SDWPBL1		; LOOP THROUGH IOPB
	RET			; RETURN

;* CHECK RESULTS OF I/O *
CKRESULT:
	CALL	DSKWAIT		; WAIT FOR WRITE TO COMPLETE

	CALL	DSKRSLT		; GET THE RESULT BYTE
	MOV	D,A		; SAVE
	ANI	1111$1110B	; DELETED DATA ?
	RZ			; YES - RETURN (OK FOR NOW)
	MOV	A,D		; RESTORE BYTE
	ANI	SEEKERR		; SEEK ERROR ?
	CNZ	RECALIB		; YES - TRY TO RECOVER
	MVI	A,1		; SET BAD RETURN CODE
	RET			; RETURN

;* GET DISK STATUS BYTE *
DSKSTAT:
	CALL	DBBWAIT		; WAIT FOR IOC TO BE FREE
	MVI	A,RDSTS			; SET COMMAND FOR OUTPUT
	OUT	IOCCNTR		; ISSUE COMMAND
	CALL	INWAIT		; WAIT FOR DATA TO BE READY
	IN	IOCDATA		; GET THE RESULT BYTE
	RET			; RETURN

;* GET DISK RESULT BYTE *
DSKRSLT:
	CALL	DBBWAIT		; WAIT FOR IOC TO BE FREE
	MVI	A,RRSTS		; SET UP COMMAND FOR OUTPUT
	OUT	IOCCNTR		; ISSUE COMMAND
	CALL	INWAIT		; WAIT FOR COMMAND TO COMPLETE
	IN	IOCDATA		; READ RESULT BYTE
	RET			; RETURN

;* DISABLE INTERRUPTS *
DISABLE:
	MVI	A,0DH		; SET DISABLE COMMAND
	OUT	0FFH		; WRITE TO CONTROL PORT
	RET			; RETURN

;* ENABLE INTERRUPTS *
ENABLE:
	MVI	A,05H		; SET ENABLE COMMAND
	OUT	0FFH		; WRITE TO CONTROL PORT
	RET			; RETURN

;* WAIT FOR IOC TO BE FREE *
DBBWAIT:
	IN	IOCCNTR		; READ DBB STATUS BYTE
	ANI	F0 OR OBF OR IBF	; ANYTHING PENDING
	JNZ	DBBWAIT		; YES - SPIN
	RET			; ELSE RETURN

;* WAIT FOR INPUT TO BE READY *
INWAIT:
	IN	IOCCNTR		; GET THE IOC STATUS BYTE
	ANI	OBF OR F0 OR IBF	; OUTPUT BUFFER FULL ?
	CPI	OBF		; VALID BUFFER ?
	JNZ	INWAIT		; NO - SPIN
	RET			; RETURN


;* DISK NOT READY *
SDERROR:
	POP	PSW		; CLEAN UP STACK
	CALL	ENABLE		; ENABLE INTERRUPTS
	MVI	A,1		; SET RETURN CODE
	RET			; RETURN

;* RECALIBRATE DISK DRIVE *
RECALIB:
	LDA	IOF		; LOAD CURRENT OP CODE
	PUSH	PSW		; SAVE
	MVI	A,RECALB	; SET RECALIBRATE OP CODE
	STA	IOF		; STORE IN IOPB
	CALL	OUTIOPB		; SEND IOBP TO IOC
	POP	PSW		; RELOAD OP CODE
	STA	IOF		; PUT BACK IN IOPB
	RET			; RETURN

;* WAIT FOR IOC TO TAKE DATA ON WRITE *
OUTWAIT:
	IN	IOCCNTR		; READ STATUS PORT
	ANI	IBF OR F0		; DATA TAKEN ?
	JNZ	OUTWAIT		; NO - SPIN
	RET			; RETURN WHEN TAKEN

;* GET DEVICE STATUS *
DEVSTAT:
	CALL	DBBWAIT		; WAIT FOR IOC TO BE READY
	MVI	A,DSTAT		; SET OP CODE FOR GET STATUS BYTE
	OUT	IOCCNTR		; SEND TO IOC
	CALL	INWAIT		; WAIT FOR IT TO BE READY
	IN	IOCDATA		; GET IT
	RET			; RETURN

;* WAIT FOR DISK TO BE READY *
DSKWAIT:
	CALL	DSKSTAT		; GET DISK STATUS
	ANI	OPCOMP		; OPERATION COMPLETED ?
	JZ	DSKWAIT		; NO - SPIN
	RET			; ELSE RETURN
;*************** END IOC CODE ***

;******************************************************************************
;		UTILITY SUBROUTINES

PRMSG:				; PRINT MESSAGE AT H,L TO 0
	MOV	A,M		;
	ORA	A		; END OF STRING?
	RZ			; YES
	PUSH	H		; NO - PRINT THIS CHARACTER
	MOV	C,A		;
	CALL	CONOUT		;
	POP	H		;
	INX	H		;
	JMP	PRMSG		;

;******************************************************************************
;		DATA AREA
;******************************************************************************

SIGNON:				;SIGNON MESSAGE: XXK CP/M VERS X.Y
	DB	CR,LF
	DB	MSIZE/10+'0',MSIZE MOD 10 + '0'
	DB	'K CP/M VERS '
	DB	VERS/10+'0','.',VERS MOD 10+'0',CR,LF
	DB	0		; END OF SIGNON MESSAGE

IOPB:				; IO PARAMETER BLOCK
	DB	80H		; NORMAL I/O OPERATION
IOF:	DB	READF		; IO FUNCTION, INITIAL READ
ION:	DB	1		; NUMBER OF SECTORS TO READ
IOT:	DB	2		; TRACK NUMBER
IOS:	DB	1		; SECTOR NUMBER
IOD:	DW	BUFF		; IO ADDRESS

SEL$TABLE:			;* DRIVE SELECT BITS *
	DB	00H,10H,20H,30H,40H
	DISKS	NUM$DISKS	; GENERATE DRIVE TABLES

	DISKDEF 0,1,52,,2048,243,128,128,2

	DISKDEF	1,0

	DISKDEF 2,1,26,6,1024,243,64,64,2

	DISKDEF	3,2

	DISKDEF	4,2

	ENDEF

IOFSV	DS	1		; SAVE AREA FOR DRIVE ADDRESS
HOLD$5	DS	1
	IF	RELOC
	DB	0	; FORCE OUT LAST ADDRESS FOR RELOCATION
	ENDIF

	END
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ;	CP/M 2.0 disk re-definition library
;
;	Copyright (c) 1979
;	Digital Research
;	Box 579
;	Pacific Grove, CA
;	93950
;
;	CP/M logical disk drives are defined using the
;	macros given below, where the sequence of calls
;	is:
;
;	disks	n
;	diskdef	parameter-list-0
;	diskdef	parameter-list-1
;	...
;	diskdef	parameter-list-n
;	endef
;
;	where n is the number of logical disk drives attached
;	to the CP/M system, and parameter-list-i defines the
;	characteristics of the ith drive (i=0,1,...,n-1)
;
;	each parameter-list-i takes the form
;		dn,fsc,lsc,[skf],bls,dks,dir,cks,ofs,[0]
;	where
;	dn	is the disk number 0,1,...,n-1
;	fsc	is the first sector number (usually 0 or 1)
;	lsc	is the last sector number on a track
;	skf	is optional "skew factor" for sector translate
;	bls	is the data block size (1024,2048,...,16384)
;	dks	is the disk size in bls increments (word)
;	dir	is the number of directory elements (word)
;	cks	is the number of dir elements to checksum
;	ofs	is the number of tracks to skip (word)
;	[0]	is an optional 0 which forces 16K/directory entry
;
;	for convenience, the form
;		dn,dm
;	defines disk dn as having the same characteristics as
;	a previously defined disk dm.
;
;	a standard four drive CP/M system is defined by
;		disks	4
;		diskdef	0,1,26,6,1024,243,64,64,2
;	dsk	set	0
;		rept	3
;	dsk	set	dsk+1
;		diskdef	%dsk,0
;		endm
;		endef
;
;	the value of "begdat" at the end of assembly defines the
;	beginning of the uninitialize ram area above the bios,
;	while the value of "enddat" defines the next location
;	following the end of the data area.  the size of this
;	area is given by the value of "datsiz" at the end of the
;	assembly.  note that the allocation vector will be quite
;	large if a large disk size is defined with a small block
;	size.
;
dskhdr	macro	dn
;;	define a single disk header list
dpe&dn:	dw	xlt&dn,0000h	;translate table
	dw	0000h,0000h	;scratch area
	dw	dirbuf,dpb&dn	;dir buff,parm block
	dw	csv&dn,alv&dn	;check, alloc vectors
	endm
;
disks	macro	nd
;;	define nd disks
ndisks	set	nd	;;for later reference
dpbase	equ	$	;base of disk parameter blocks
;;	generate the nd elements
dsknxt	set	0
	rept	nd
	dskhdr	%dsknxt
dsknxt	set	dsknxt+1
	endm
	endm
;
dpbhdr	macro	dn
dpb&dn	equ	$		;disk parm block
	endm
;
ddb	macro	data,comment
;;	define a db statement
	db	data		comment
	endm
;
ddw	macro	data,comment
;;	define a dw statement
	dw	data		comment
	endm
;
gcd	macro	m,n
;;	greatest common divisor of m,n
;;	produces value gcdn as result
;;	(used in sector translate table generation)
gcdm	set	m	;;variable for m
gcdn	set	n	;;variable for n
gcdr	set	0	;;variable for r
	rept	65535
gcdx	set	gcdm/gcdn
gcdr	set	gcdm - gcdx*gcdn
	if	gcdr = 0
	exitm
	endif
gcdm	set	gcdn
gcdn	set	gcdr
	endm
	endm
;
diskdef	macro	dn,fsc,lsc,skf,bls,dks,dir,cks,ofs,k16
;;	generate the set statements for later tables
	if	nul lsc
;;	current disk dn same as previous fsc
dpb&dn	equ	dpb&fsc	;equivalent parameters
als&dn	equ	als&fsc	;same allocation vector size
css&dn	equ	css&fsc	;same checksum vector size
xlt&dn	equ	xlt&fsc	;same translate table
	else
secmax	set	lsc-(fsc)	;;sectors 0...secmax
sectors	set	secmax+1;;number of sectors
als&dn	set	(dks)/8	;;size of allocation vector
	if	((dks) mod 8) ne 0
als&dn	set	als&dn+1
	endif
css&dn	set	(cks)/4	;;number of checksum elements
;;	generate the block shift value
blkval	set	bls/128	;;number of sectors/block
blkshf	set	0	;;counts right 0's in blkval
blkmsk	set	0	;;fills with 1's from right
	rept	16	;;once for each bit position
	if	blkval=1
	exitm
	endif
;;	otherwise, high order 1 not found yet
blkshf	set	blkshf+1
blkmsk	set	(blkmsk shl 1) or 1
blkval	set	blkval/2
	endm
;;	generate the extent mask byte
blkval	set	bls/1024	;;number of kilobytes/block
extmsk	set	0	;;fill from right with 1's
	rept	16
	if	blkval=1
	exitm
	endif
;;	otherwise more to shift
extmsk	set	(extmsk shl 1) or 1
blkval	set	blkval/2
	endm
;;	may be double byte allocation
	if	(dks) > 256
extmsk	set	(extmsk shr 1)
	endif
;;	may be optional [0] in last position
	if	not nul k16
extmsk	set	k16
	endif
;;	now generate directory reservation bit vector
dirrem	set	dir	;;# remaining to process
dirbks	set	bls/32	;;number of entries per block
dirblk	set	0	;;fill with 1's on each loop
	rept	16
	if	dirrem=0
	exitm
	endif
;;	not complete, iterate once again
;;	shift right and add 1 high order bit
dirblk	set	(dirblk shr 1) or 8000h
	if	dirrem > dirbks
dirrem	set	dirrem-dirbks
	else
dirrem	set	0
	endif
	endm
	dpbhdr	dn	;;generate equ $
	ddw	%sectors,<;sec per track>
	ddb	%blkshf,<;block shift>
	ddb	%blkmsk,<;block mask>
	ddb	%extmsk,<;extnt mask>
	ddw	%(dks)-1,<;disk size-1>
	ddw	%(dir)-1,<;directory max>
	ddb	%dirblk shr 8,<;alloc0>
	ddb	%dirblk and 0ffh,<;alloc1>
	ddw	%(cks)/4,<;check size>
	ddw	%ofs,<;offset>
;;	generate the translate table, if requested
	if	nul skf
xlt&dn	equ	0		;no xlate table
	else
	if	skf = 0
xlt&dn	equ	0		;no xlate table
	else
;;	generate the translate table
nxtsec	set	0	;;next sector to fill
nxtbas	set	0	;;moves by one on overflow
	gcd	%sectors,skf
;;	gcdn = gcd(sectors,skew)
neltst	set	sectors/gcdn
;;	neltst is number of elements to generate
;;	before we overlap previous elements
nelts	set	neltst	;;counter
xlt&dn	equ	$		;translate table
	rept	sectors	;;once for each sector
	if	sectors < 256
	ddb	%nxtsec+(fsc)
	else
	ddw	%nxtsec+(fsc)
	endif
nxtsec	set	nxtsec+(skf)
	if	nxtsec >= sectors
nxtsec	set	nxtsec-sectors
	endif
nelts	set	nelts-1
	if	nelts = 0
nxtbas	set	nxtbas+1
nxtsec	set	nxtbas
nelts	set	neltst
	endif
	endm
	endif	;;end of nul fac test
	endif	;;end of nul bls test
	endm
;
defds	macro	lab,space
lab:	ds	space
	endm
;
lds	macro	lb,dn,val
	defds	lb&dn,%val&dn
	endm
;
endef	macro
;;	generate the necessary ram data areas
begdat	equ	$
dirbuf:	ds	128	;directory access buffer
dsknxt	set	0
	rept	ndisks	;;once for each disk
	lds	alv,%dsknxt,als
	lds	csv,%dsknxt,css
dsknxt	set	dsknxt+1
	endm
enddat	equ	$
datsiz	equ	$-begdat
;;	db 0 at this point forces hex record
	endm
;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ;******************************************************************************
                ;******************************************************************************
                ;		BIOS21I				VERSION 820505/1200|RACIII/JCM
                ;------------------------------------------------------------------------------
                ;				SUPPORTING
                ;	DRIVE NAME	DENSITY		CONTROLLER	BASE ADDRESS
                ;	----------	-------		----------	------------
                ;	A:, B:		DOUBLE		202		78H
                ;	C:, D:		SINGLE		201		88H
                ;	E:		SINGLE		IOC		C0H
                ;------------------------------------------------------------------------------
                ;	COPYRIGHT (C) 1978, 1979	|	COPYRIGHT (C) 1982
                ;	DIGITAL RESEARCH		|	INTEL CORP.
                ;	BOX 579, PACIFIC GROVE		|	3065 BOWERS AVENUE
                ;	CALIFORNIA, 93950		|	SANTA CLARA, CALIFORNIA 95051
                ;******************************************************************************
                ;******************************************************************************
                
                
                ;******************** EQUATES *************************************************
                
                	MACLIB	DISKDEF
                
 0016 =         VERS	EQU	22		; CP/M VERSION 2.2
 0000 =         FALSE	EQU	0
 FFFF =         TRUE	EQU	NOT FALSE
                
 0000 =         RELOC	EQU	FALSE
                
                	IF NOT RELOC
 003E =         MSIZE	EQU	62		; MEMORY SIZE IN KILOBYTES
 F800 =         RAM$TOP	EQU	MSIZE*1024	; TOP ADDRESS+1
 F000 =         BIOS	EQU	RAM$TOP-800H	; BASIC INPUT/OUTPUT SYSTEM
 E200 =         BDOS	EQU	BIOS-0E00H	; BASE OF THE BDOS
 DA00 =         CCP	EQU	BDOS-0800H	; THE CONSOLE COMMAND PROCESSOR
 F000           	ORG	BIOS
                	ENDIF
                
                	IF RELOC
                	ORG	0		; OR 0100H FOR REL-1
                CCP	EQU	$
                BDOS	EQU	CCP+0800H
                BIOS	EQU	BDOS+0E00H
                MSIZE	EQU	0		; DUMMY FOR SIGN-ON MESSAGE
                	ORG	0800H+0E00H	; PLUS ANOTHER 0100H FOR REL-1
                	ENDIF
                
                
 1600 =         CPML	EQU	BIOS-CCP
 002C =         NSECTS	EQU	CPML/128	; NUMBER OF SECTORS TO LOAD
                
 0004 =         CDISK	EQU	0004H		; ADDRESS OF LAST LOGGED DISK ON WARM START
 0080 =         BUFF	EQU	0080H		; DEFAULT BUFFER ADDRESS
                
 0003 =         IOBYTE	EQU	0003H		; ADDRESS OF IO BYTE FOR MONITOR
 0081 =         IOBYTI	EQU	0081H		; INITIAL VALUE FOR IOBYTE
                
 00FD =         INT$CONT$1	EQU	0FDH	; INTERRUPT PRIORITY RESTORE PORT
 00FC =         INT$CONT$0	EQU	0FCH	; INTERRUPT MASK PORT
 00F3 =         MON$INT		EQU	0F3H	; INTERRUPT CONTROL PORT
 007E =         INT$MASK	EQU	0111$1110B	; ENABLE RST 0(WBOOT), RST 7 (MONITOR)
                
                ;	MDS MONITOR EQUATES
                
 F800 =         MON80	EQU	0F800H
 FF0F =         RMON80	EQU	0FF0FH		; RESTART MON80 (BOOT ERROR)
 F803 =         CI	EQU	0F803H
 F809 =         CO	EQU	0F809H
 F812 =         CSTS	EQU	0F812H
 F806 =         RI	EQU	0F806H
 F80C =         PO	EQU	0F80CH
 F80F =         LO	EQU	0F80FH
                
 000D =         CR	EQU	0DH		; CARRIAGE RETURN
 000A =         LF	EQU	0AH		; LINE FEED
                
                ;*************** DISK EQUATES *************************************************
                
 000A =         RETRY	EQU	10		; MAX RETRIES ON DISK I/O BEFORE ERROR
 0005 =         NUM$DISKS	EQU	5	; NUMBER OF DRIVES AVAILABLE
                
                ;*************** 202 CONTROLLER EQUATES ***************************************
                
 0078 =         BASE2	EQU	78H		; BASE OF DISK COMMAND IO PORTS
 0078 =         DSTAT2	EQU	BASE2		; DISK STATUS (INPUT)
 0079 =         RTYPE2	EQU	BASE2+1		; RESULT TYPE (INPUT)
 007B =         RBYTE2	EQU	BASE2+3		; RESULT BYTE (INPUT)
                
 0079 =         ILOW2	EQU	BASE2+1		; IOPB LOW ADDRESS (OUTPUT)
 007A =         IHIGH2	EQU	BASE2+2		; IOPB HIGH ADDRESS (OUTPUT)
                
 0004 =         READF	EQU	4H		; READ FUNCTION
 0006 =         WRITF	EQU	6H		; WRITE FUNCTION
 0003 =         RECAL	EQU	3H		; RECALIBRATE DRIVE
 0004 =         IORDY	EQU	4H		; I/O FINISHED MASK
                
                ;*************** 201 CONTROLLER EQUATES ***************************************
                
 0088 =         BASE	EQU	88H		; BASE OF DISK COMMAND IO PORTS
 0088 =         DSTAT	EQU	BASE		; DISK STATUS (INPUT)
 0089 =         RTYPE	EQU	BASE+1		; RESULT TYPE (INPUT)
 008B =         RBYTE	EQU	BASE+3		; RESULT BYTE (INPUT)
                
 0089 =         ILOW	EQU	BASE+1		; IOPB LOW ADDRESS (OUTPUT)
 008A =         IHIGH	EQU	BASE+2		; IOPB HIGH ADDRESS (OUTPUT)
                
 0004 =         READF	EQU	4H		; READ FUNCTION
 0006 =         WRITF	EQU	6H		; WRITE FUNCTION
 0003 =         RECAL	EQU	3H		; RECALIBRATE DRIVE
 0004 =         IORDY	EQU	4H		; I/O FINISHED MASK
                
                ;*************** IOC CONTROLLER EQUATES ***************************************
                
                ;*** IOC COMMANDS ***
 0003 =         RDSTAT	EQU	00011B		; READ DEVICE STATUS
 0015 =         WPBC	EQU	10101B		; WRITE FIRST BYTE OF PBC
 0016 =         WPBCC	EQU	10110B		; WRITE NEXT BYTE OF PBC (5 BYTES TOTAL)
 0017 =         WDBC	EQU	10111B		; WRITE DISKETTE DATA BYTES
 0019 =         RDBC	EQU	11001B		; READ DISKETE DATA BYTES
 001B =         RRSTS	EQU	11011B		; READ DISKETTE RESULT BYTE
 001C =         RDSTS	EQU	11100B		; READ DISKETTE STATUS BYTE
                
                ;**** I/O PORTS ****
 00C0 =         IOCDATA	EQU	0C0H		; DATA PORT
 00C1 =         IOCCNTR	EQU	0C1H		; CONTROL PORT
                
                	;**** DISK RESULT BYTE ****
 0004 =         SEEKERR	EQU	0000100B	; SEEK ERROR
                
                	;**** DBB STATUS BYTE ****
 0001 =         OBF	EQU	1B		; OUTPUT BUFFER FULL
 0002 =         IBF	EQU	10B		; INPUT BUFFER FULL
 0004 =         F0	EQU	100B		; COMMAND STATUS FLAG (ON=ACCEPTED OFF=COMPLETED)
 0008 =         CD	EQU	1000B		; COMMAND/DATA FLAG (ON=STATUS OFF=DATA)
                
                
                	;**** DISKETTE STATUS BYTE FLAGS ****
 0001 =         READY	EQU	1B		; ON=DEVICE IS READY
 0004 =         OPCOMP	EQU	100B		; OPERATION COMPLETED
 0008 =         PRESENT	EQU	1000B		; DEVICE IS PHISICALLY PRESENT
 0020 =         ILLDATA	EQU	100000B		; ILLEGAL DATA SENT
 0040 =         ILLSTAT	EQU	1000000B	; ILLEGAL INTERUPT REQUEST
                
                ;**** DEVICE STATUS BYTE ****
 0080 =         DSKERR	EQU	10000000B	; DISK ERROR FLAG
                
                ;**** UNIQUE DISKETTE OPERATION CODES ****
 0003 =         RECALB	EQU	011B		; RECALIBRATE DISK
                
                
                ;******************************************************************************
                ;		JUMP VECTOR FOR INDIVIUAL ROUTINES
                ;******************************************************************************
                
 F000 C333F0    	JMP	BOOT
 F003 C366F0    WBOOTE:	JMP	WBOOT
 F006 C3C4F0    	JMP	CONSTAT
 F009 C3B6F0    	JMP	CONIN
 F00C C3C0F0    	JMP	CONOUT
 F00F C3C8F0    	JMP	LIST
 F012 C3D0F0    	JMP	PUNCH
 F015 C3CCF0    	JMP	READER
 F018 C308F1    	JMP	HOME
 F01B C3E9F0    	JMP	SELDSK
 F01E C30AF1    	JMP	SETTRK
 F021 C30FF1    	JMP	SETSEC
 F024 C314F1    	JMP	SETDMA
 F027 C326F1    	JMP	READ
 F02A C338F1    	JMP	WRITE
 F02D C3E7F0    	JMP	LIST$ST		; LIST STATUS POLL
 F030 C31AF1    	JMP	SECT$TRAN	; SECTOR TRANSLATION
                
                ;******************************************************************************
                ;		CODE SECTION
                ;******************************************************************************
                
 F033 310001    BOOT:	LXI	SP,BUFF+80H	; TEMPORARY STACK POINTER
                				; SET UP INTERRUPTS FOR 0 AND 7 ENABLED
 F036 F3        	DI
 F037 3E12      	MVI	A,12H		; GIVE NON-EXISTANT I8259 INTERRUPT CONTROLLER
 F039 D3FD      	OUT	INT$CONT$1	 ; IT'S INTIALIZATION SEQUENCE
 F03B AF        	XRA	A
 F03C D3FC      	OUT	INT$CONT$0	; THIS ACTUALLY ALLOWS PENDING INTERRUPTS
                				;  ON TO HAPPEN, BUT INTEL SEZ
                				;  DO IT TO IT FOR THE I8259 COMPATIBILITY
                
 F03E 3E7E      	MVI	A,INT$MASK	; RST0 AND RST7 BITS ON
 F040 D3FC      	OUT	INT$CONT$0
 F042 AF        	XRA	A
 F043 D3F3      	OUT	MON$INT		; MASK ALL MONITOR BOARD INTERRUPTS
                
                ;	PLUG ALL UNUSED INTERRUPT VECTORS WITH RST 7
                ;	SO UNEXPECTED INTERRUPTS WILL BREAKPOINT TO MDSMON
                
                
 F045 210800    	LXI	H,00008H	; POINT TO RESTART 1 LOCATION
 F048 54        	MOV	D,H		; KEEP VALUE 8 FOR INCREMENT
 F049 5D        	MOV	E,L		;
 F04A 0E06      	MVI	C,6		; WE WANT TO INIT. SIX RESTARTS
                FILL$LOOP:
 F04C 36FF      	MVI	M,0FFH		; PLUG IN A RESTART 7 INSTR.
 F04E 19        	DAD	D		; POINT TO NEXT RESTART LOCATION
 F04F 0D        	DCR	C		; DROP COUNT
 F050 C24CF0    	JNZ	FILL$LOOP	; AND ITERATE
                
 F053 3A0500    	LDA	5		; GET MDSMON'S LOCATION 5 TO SAVE
 F056 32B9F5    	STA	HOLD$5		; FOR COMPATIBILITY WITH MDS230
                
 F059 AF        	XRA	A		; CLEAR ACCUMULATOR
 F05A 320400    	STA	CDISK		; SET INITIALLY TO DISK A/USER 0
                
 F05D 2183F3    	LXI	H,SIGN$ON	;
 F060 CD76F3    	CALL	PRMSG		;
 F063 C38CF0    	JMP	GOCPM		; GO TO CP/M
                
                
                WBOOT:
 F066 310001    	LXI	SP,0100H	 ; TEMP STACK POINTER
                WBOOT0:
 F069 0100DA    	LXI	B,CCP		; SET DMA ADDRESS TO START OF DISK SYSTEM
 F06C CD14F1    	CALL	SETDMA
                
 F06F 0E00      	MVI	C,0		; BOOT FROM DRIVE 0
 F071 CDE9F0    	CALL	SELDSK
 F074 CD08F1    	CALL	HOME
                
 F077 0E02      	MVI	C,2		; START READING SECTOR 2
 F079 CD0FF1    	CALL	SETSEC
                
                ;	READ MULTIPLE SECTORS, COUNT NSECTS TO ZERO
                ;* IF NSECTS EVER GETS LARGER THAN 51 THAN THIS BOOT NEEDS TO
                ;* BE MODIFIED.
 F07C 3E2C      	MVI	A,NSECTS
 F07E 329BF3    	STA	ION		; SAVE IN IOPB
 F081 CD26F1    	CALL	READ		; DO READ
 F084 C266F0    	JNZ	WBOOT		; REPEAT IF ERROR
 F087 3E01      	MVI	A,1		; SET NUMBER OF SECTORS TO 1 
 F089 329BF3    	STA	ION		; FOR REST OF WORLD
                
                
                ;
                GOCPM:	;(ENTER HERE FROM COLD START BOOT)
                
                ;	SET UP PAGE ZERO JUMPS TO WARM BOOT, BDOS, AND MDSMON BREAKPOINT
                
 F08C 3EC3      	MVI	A,JMP
 F08E 320000    	STA	0
 F091 2103F0    	LXI	H,WBOOTE
 F094 220100    	SHLD	1		; JMP WBOOT AT LOCATION 00
 F097 320500    	STA	5
 F09A 2106E2    	LXI	H,BDOS+6
 F09D 220600    	SHLD	6		; JMP BDOS AT LOCATION 5
 F0A0 323800    	STA	7*8		; JMP TO MON80 (MAY HAVE BEEN CHANGED BY DDT)
 F0A3 210FFF    	LXI	H,RMON80
 F0A6 223900    	SHLD	7*8+1
                
                ; SET I/O BYTE
                
 F0A9 3E81      	MVI	A,IOBYTI	; INITIAL VALUE FOR IOBYTE
 F0AB 320300    	STA	IOBYTE		; ***
                
 F0AE 3A0400    	LDA	CDISK		; LAST LOGGED DISK NUMBER
 F0B1 4F        	MOV	C,A		; SEND TO CCP TO LOG IT IN
                
 F0B2 FB        	EI
 F0B3 C300DA    	JMP	CCP
                
                CONIN:
 F0B6 CDBCF0    	CALL	CI1
 F0B9 E67F      	ANI	7FH
 F0BB C9        	RET
                CI1:
 F0BC CDD4F0    	CALL	MON
 F0BF 03        	DB	0FFH AND CI
                CONOUT:
 F0C0 CDD4F0    	CALL	MON
 F0C3 09        	DB	0FFH AND CO
                CONSTAT:
 F0C4 CDD4F0    	CALL	MON
 F0C7 12        	DB	0FFH AND CSTS
                LIST:
 F0C8 CDD4F0    	CALL	MON
 F0CB 0F        	DB	0FFH AND LO
                READER:
 F0CC CDD4F0    	CALL	MON
 F0CF 06        	DB	0FFH AND RI
                PUNCH:
 F0D0 CDD4F0    	CALL	MON
 F0D3 0C        	DB	0FFH AND PO
                MON:				; PATCH FOR LOC. 5
 F0D4 210500    	LXI	H,00005H	; RESTORE MDS LOC. 5
 F0D7 3AB9F5    	LDA	HOLD$5		;
 F0DA 77        	MOV	M,A		;
 F0DB E3        	XTHL			; FETCH & BUILD MON CALL ADDRESS
 F0DC 6E        	MOV	L,M		;
 F0DD 26F8      	MVI	H,0F8H		;
 F0DF CDE6F0    	CALL	CALLER		; VECTOR TO APPROPRITIATE MDSMON ENTRY
 F0E2 E1        	POP	H		; RESTORE CP/M'S BDOS VECTOR OPCODE
 F0E3 36C3      	MVI	M,0C3H		;
 F0E5 C9        	RET			;
                
 F0E6 E9        CALLER:	PCHL
                
 F0E7 AF        LIST$ST:XRA	A		; NOT IMPLEMENTED
 F0E8 C9        	RET			;
                
                SELDSK:				;SELECT DISK GIVEN BY REGISTER C
 F0E9 210000    	LXI	H,0000		; FIRST, INSURE GOOD SELECT
 F0EC 79        	MOV	A,C		;
 F0ED FE05      	CPI	NUM$DISKS	;
 F0EF D0        	RNC			;
 F0F0 21A0F3    	LXI	H,SEL$TABLE	;
 F0F3 0600      	MVI	B,0		;
 F0F5 09        	DAD	B		;
 F0F6 7E        	MOV	A,M		;
 F0F7 329AF3    	STA	IOF		;
 F0FA 32B8F5    	STA	IOFSV		; SAVE DRIVE ADDRESS
 F0FD 60        	MOV	H,B		; GET DRIVE CODE TO [HL]
 F0FE 69        	MOV	L,C		;
 F0FF 29        	DAD	H		; MULTIPLY BY 16
 F100 29        	DAD	H		;
 F101 29        	DAD	H		;
 F102 29        	DAD	H		;
 F103 11A5F3    	LXI	D,DPBASE	; AND MAKE ADDRESS OF DRIVE TABLE
 F106 19        	DAD	D		;
 F107 C9        	RET
                
                HOME:				;MOVE TO HOME POSITION
 F108 0E00      	MVI	C,0
                SETTRK:				;SET TRACK ADDRESS GIVEN BY C
 F10A 219CF3    	LXI	H,IOT
 F10D 71        	MOV	M,C
 F10E C9        	RET
                ;
                SETSEC:				; SET SECTOR NUMBER GIVEN BY C
 F10F 79        	MOV	A,C		; SECTOR NUMBER TO ACCUM
 F110 329DF3    	STA	IOS		; STORE SECTOR NUMBER TO IOPB
 F113 C9        	RET
                ;
                SETDMA:				; SET DMA ADDRESS GIVEN BY REGS B,C
 F114 69        	MOV	L,C
 F115 60        	MOV	H,B
 F116 229EF3    	SHLD	IOD
 F119 C9        	RET
                
                SECT$TRAN:			; TRANSLATE THE SECTOR # IN <C> IF NEEDED
 F11A 60        	MOV	H,B		; IN CASE OF NO TRANSLATION
 F11B 69        	MOV	L,C		;
 F11C 23        	INX	H		;
 F11D 7A        	MOV	A,D		; (TRANTAB) = 0 , AND RETURN
 F11E B3        	ORA	E		;
 F11F C8        	RZ			;
 F120 EB        	XCHG			; ELSE, OFFSET TABLE LOGICAL SECTOR
 F121 09        	DAD	B		;
 F122 6E        	MOV	L,M		; THEN FETCH THE PHYSICAL SECTOR
 F123 2600      	MVI	H,0		;
 F125 C9        	RET
                
                ;******************************************************************************
                ;		DISK DRIVERS
                ;******************************************************************************
                
 F126 3AB8F5    READ:	LDA	IOFSV		; CHOOSE WHICH DRIVER CODE TO USE
 F129 4F        	MOV	C,A		; HOLD SELECT CODE
 F12A E640      	ANI	040H		; TEST IF IOC SELECTED
 F12C C20EF2    	JNZ	READI		; YES - USE IOC DRIVER
 F12F 79        	MOV	A,C		; RESTORE [A]
 F130 E620      	ANI	020H		; TEST IF 201 SELECTED
 F132 C2A7F1    	JNZ	READ1		; YES - USE 201 DRIVER
 F135 C34AF1    	JMP	READ2		; IF NONE OF THE ABOVE - USE 202 DRIVER
                
 F138 3AB8F5    WRITE:	LDA	IOFSV		; CHOOSE WHICH DRIVER CODE TO USE
 F13B 4F        	MOV	C,A		; HOLD SELECT CODE
 F13C E640      	ANI	040H		; TEST IF IOC SELECTED
 F13E C213F2    	JNZ	WRITEI		; YES - USE IOC DRIVER
 F141 79        	MOV	A,C		; RESTORE [A]
 F142 E620      	ANI	020H		; TEST IF 201 SELECTED
 F144 C2ACF1    	JNZ	WRITE1		; YES - USE 201 DRIVER
 F147 C34FF1    	JMP	WRITE2		; IF NONE OF THE ABOVE - USE 202 DRIVER
                
                ;*************** 202 CONTROLLER DRIVER CODE ***********************************
                
                READ2:				; READ NEXT DISK RECORD ( DISK/TRK/SEC/DMA SET)
 F14A 0E04      	MVI	C,READF		; SET TO READ FUNCTION
 F14C C351F1    	JMP	SETFUNC2
                
                WRITE2:				; DISK WRITE FUNCTION
 F14F 0E06      	MVI	C,WRIT:10F00000C333F0C366F0C3C4F0C3B6F0C3C0F0C3EB
:10F01000C8F0C3D0F0C3CCF0C308F1C3E9F0C30A11
:10F02000F1C30FF1C314F1C326F1C338F1C3E7F004
:10F03000C31AF1310001F33E12D3FDAFD3FC3E7E83
:10F04000D3FCAFD3F3210800545D0E0636FF190D33
:10F05000C24CF03A050032B9F5AF3204002183F317
:10F06000CD76F3C38CF03100010100DACD14F10E3E
:10F0700000CDE9F0CD08F10E02CD0FF13E2C329B10
:10F08000F3CD26F1C266F03E01329BF33EC332005F
:10F09000002103F02201003205002106E2220600D1
:10F0A000323800210FFF2239003E813203003A043A
:10F0B000004FFBC300DACDBCF0E67FC9CDD4F0032E
:10F0C000CDD4F009CDD4F012CDD4F00FCDD4F006CC
:10F0D000CDD4F00C2105003AB9F577E36E26F8CDD2
:10F0E000E6F0E136C3C9E9AFC921000079FE05D0D9
:10F0F00021A0F30600097E329AF332B8F56069293F
:10F1000029292911A5F319C90E00219CF371C97988
:10F11000329DF3C96960229EF3C96069237AB3C83E
:10F12000EB096E2600C93AB8F54FE640C20EF279F7
:10F13000E620C2A7F1C34AF13AB8F54FE640C21340
:10F14000F279E620C2ACF1C34FF10E04C351F10EC7
:10F15000063E803299F3219AF37EE6F8B1770E0AE3
:10F16000CD9EF1CDA1F13E9906F3D37978D37ACD36
:10F17000A4F1E604CA6FF1CD9EF1FE02CA91F1B787
:10F18000C297F1CDA1F117DA91F11FE6FEC297F116
:10F19000C9CDA1F1C397F10DC260F13E01C9DB7980
:10F1A000C9DB7BC9DB78C90E04C3AEF10E063E8015
:10F1B0003299F3219AF37EE6F8B177E620219DF3A8
:10F1C000B6770E0ACD05F2CD08F23E9906F3D38943
:10F1D00078D38AC3D6F1CD0BF2E604CAD6F1CD05B9
:10F1E000F2FE02CAF8F1B7C2FEF1CD08F217DAF862
:10F1F000F11FE6FEC2FEF1C9CD08F2C3FEF10DC259
:10F20000C4F13E01C9DB89C9DB8BC9DB88C90E04A7
:10F21000C315F20E063E803299F3219AF37EE6F88A
:10F22000B1773AB8F5E640CAC2F1CD24F30E0ACD63
:10F230000AF3F5E601C240F20DCA40F3F1C32FF222
:10F24000F1E604CA4CF2CD17F3C32DF23E00329919
:10F25000F33A9AF3E607329AF30E0AFE04CA9DF2D5
:10F26000CD2EF33E17D3C1CD2EF33A9BF3D3C0CDB1
:10F270002EF32A9EF33A9BF3F516807ED3C0CD5829
:10F28000F32315C27BF2F13DC278F2CDDAF2CD293B
:10F29000F3CDF7F2B7C80DC260F23E01C9CD2EF32F
:10F2A000CDDAF2CDF7F2B7CAB4F20DC29DF2CD2994
:10F2B000F33E01C9CD2EF33E19D3C12A9EF33A9BEA
:10F2C000F3F51680CD36F3DBC0772315C2C4F2F117
:10F2D0003DC2C1F2CD29F3F
                
                SETFUNC2:
                ;	SET FUNCTION FOR NEXT I/O (COMMAND IN REG-C)
 F151 3E80      	MVI	A,80H		; INITIALIZE IOPB FOR DUAL DENSITY 202
 F153 3299F3    	STA	IOPB		;	*
 F156 219AF3    	LXI	H,IOF		; IO FUNCTION ADDRESS
 F159 7E        	MOV	A,M		; GET IT TO ACCUMULATOR FOR MASKING
 F15A E6F8      	ANI	1111$1000B	; REMOVE PREVIOUS COMMAND
 F15C B1        	ORA	C		; SET TO NEW COMMAND
 F15D 77        	MOV	M,A		; REPLACED IN IOPB
                
                WAITIO2:
 F15E 0E0A      	MVI	C,RETRY		; MAX RETRIES BEFORE PERM ERROR
                REWAIT2:
                ;	START THE I/O FUNCTION AND WAIT FOR COMPLETION
 F160 CD9EF1    	CALL	INTYPE2		; IN RTYPE
 F163 CDA1F1    	CALL	INBYTE2		; CLEARS THE CONTROLLER
                
 F166 3E99      	MVI	A,IOPB AND 0FFH	; LOW ADDRESS FOR IOPB
 F168 06F3      	MVI	B,IOPB SHR 8	; HIGH ADDRESS FOR IOPB
 F16A D379      	OUT	ILOW2		; LOW ADDRESS TO CONTROLLER
 F16C 78        	MOV	A,B
 F16D D37A      	OUT	IHIGH2		; HIGH ADDRESS
                
 F16F CDA4F1    WAIT02:	CALL	INSTAT2		; WAIT FOR COMPLETION
 F172 E604      	ANI	IORDY		; READY?
 F174 CA6FF1    	JZ	WAIT02
                
                ;	CHECK IO COMPLETION OK
 F177 CD9EF1    	CALL	INTYPE2		; MUST BE IO COMPLETE (00) UNLINKED
                ;	00 UNLINKED I/O COMPLETE,    01 LINKED I/O COMPLETE (NOT USED)
                ;	10 DISK STATUS CHANGED       11 (NOT USED)
                
 F17A FE02      	CPI	10B		; READY STATUS CHANGE?
 F17C CA91F1    	JZ	WREADY2
                
                ;	MUST BE 00 IN THE ACCUMULATOR
 F17F B7        	ORA	A
 F180 C297F1    	JNZ	WERROR2		; SOME OTHER CONDITION, RETRY
                
                ;	CHECK I/O ERROR BITS
 F183 CDA1F1    	CALL	INBYTE2
 F186 17        	RAL
 F187 DA91F1    	JC	WREADY2		; UNIT NOT READY
 F18A 1F        	RAR
 F18B E6FE      	ANI	11111110B	; ANY OTHER ERRORS?  (DELETED DATA OK)
 F18D C297F1    	JNZ	WERROR2
                
                ;	READ OR WRITE IS OK, ACCUMULATOR CONTAINS ZERO
 F190 C9        	RET
                
                WREADY2:				; NOT READY, TREAT AS ERROR FOR NOW
 F191 CDA1F1    	CALL	INBYTE2		; CLEAR RESULT BYTE
 F194 C397F1    	JMP	TRYCOUNT2
                
                WERROR2:			; RETURN MALFUNCTION (CRC, TRACK, SEEK, ETC.)
                ;	THE MDS CONTROLLER HAS RETURNED A BIT IN EACH POSITION
                ;	OF THE ACCUMULATOR, CORRESPONDING TO THE CONDITIONS:
                ;	0	- DELETED DATA (ACCEPTED AS OK ABOVE)
                ;	1	- CRC ERROR
                ;	2	- SEEK ERROR
                ;	3	- ADDRESS ERROR (HARDWARE MALFUNCTION)
                ;	4	- DATA OVER/UNDER FLOW (HARDWARE MALFUNCTION)
                ;	5	- WRITE PROTECT (TREATED AS NOT READY)
                ;	6	- WRITE ERROR (HARDWARE MALFUNCTION)
                ;	7	- NOT READY
                ;	(ACCUMULATOR BITS ARE NUMBERED 7 6 5 4 3 2 1 0)
                
                TRYCOUNT2:
                ;	REGISTER C CONTAINS RETRY COUNT, DECREMENT 'TIL ZERO
 F197 0D        	DCR	C
 F198 C260F1    	JNZ	REWAIT2		; FOR ANOTHER TRY
                
                ;	CANNOT RECOVER FROM ERROR
 F19B 3E01      	MVI	A,1		; ERROR CODE
 F19D C9        	RET
                
                ;	INTYPE, INBYTE, INSTAT READ DRIVE BANK 00 OR 10
                INTYPE2:
 F19E DB79      	IN	RTYPE2
 F1A0 C9        	RET
                
                INBYTE2:
 F1A1 DB7B      	IN	RBYTE2
 F1A3 C9        	RET
                
                INSTAT2:
 F1A4 DB78      	IN	DSTAT2
 F1A6 C9        	RET
                ;*************** END 202 CODE ***
                
                ;*************** 201 CONTROLLER DRIVER ****************************************
                
                READ1:				; READ NEXT DISK RECORD ( DISK/TRK/SEC/DMA SET)
 F1A7 0E04      	MVI	C,READF		; SET TO READ FUNCTION
 F1A9 C3AEF1    	JMP	SETFUNC
                ;
                WRITE1:				; DISK WRITE FUNCTION
 F1AC 0E06      	MVI	C,WRITF
                ;
                SETFUNC:
                ;	SET FUNCTION FOR NEXT I/O (COMMAND IN REG-C)
                
 F1AE 3E80      	MVI	A,80H
 F1B0 3299F3    	STA	IOPB		; RESTORE IOPB CHANNEL COMMAND	820504
                
 F1B3 219AF3    	LXI	H,IOF		; IO FUNCTION ADDRESS
 F1B6 7E        	MOV	A,M		; GET IT TO ACCUMULATOR FOR MASKING
 F1B7 E6F8      	ANI	1111$1000B	;REMOVE PREVIOUS COMMAND
 F1B9 B1        	ORA	C		; SET TO NEW COMMAND
 F1BA 77        	MOV	M,A		; REPLACED IN IOPB
                ;	SINGLE DENSITY DRIVE 1 REQUIRES BIT 5 ON IN SECTOR #
                ;	MASK THE BIT FROM THE CURRENT I/O FUNCTION
 F1BB E620      	ANI	0010$0000B	;MASK THE DISK SELECT BIT
 F1BD 219DF3    	LXI	H,IOS		;ADDRESS THE SECTOR SELECT BYTE
 F1C0 B6        	ORA	M		;SELECT PROPER DISK BANK
 F1C1 77        	MOV	M,A		;SET DISK SELECT BIT ON/OFF
                ;
                WAITIO:
 F1C2 0E0A      	MVI	C,RETRY		; MAX RETRIES BEFORE PERM ERROR
                REWAIT:
                ;	START THE I/O FUNCTION AND WAIT FOR COMPLETION
 F1C4 CD05F2    	CALL	INTYPE		; IN RTYPE
 F1C7 CD08F2    	CALL	INBYTE		; CLEARS THE CONTROLLER
                
 F1CA 3E99      	MVI	A,IOPB AND 0FFH	; LOW ADDRESS FOR IOPB
 F1CC 06F3      	MVI	B,IOPB SHR 8	; HIGH ADDRESS FOR IOPB
 F1CE D389      	OUT	ILOW		; LOW ADDRESS TO CONTROLLER
 F1D0 78        	MOV	A,B
 F1D1 D38A      	OUT	IHIGH		; HIGH ADDRESS
 F1D3 C3D6F1    	JMP	WAIT0		; TO WAIT FOR COMPLETE
                
 F1D6 CD0BF2    WAIT0:	CALL	INSTAT		; WAIT FOR COMPLETION
 F1D9 E604      	ANI	IORDY		; READY?
 F1DB CAD6F1    	JZ	WAIT0
                
                ;	CHECK IO COMPLETION OK
 F1DE CD05F2    	CALL	INTYPE		; MUST BE IO COMPLETE (00) UNLINKED
                ;	00 UNLINKED I/O COMPLETE,    01 LINKED I/O COMPLETE (NOT USED)
                ;	10 DISK STATUS CHANGED       11 (NOT USED)
 F1E1 FE02      	CPI	10B		; READY STATUS CHANGE?
 F1E3 CAF8F1    	JZ	WREADY
                
                ;	MUST BE 00 IN THE ACCUMULATOR
 F1E6 B7        	ORA	A
 F1E7 C2FEF1    	JNZ	WERROR		; SOME OTHER CONDITION, RETRY
                
                ;	CHECK I/O ERROR BITS
 F1EA CD08F2    	CALL	INBYTE
 F1ED 17        	RAL
 F1EE DAF8F1    	JC	WREADY		; UNIT NOT READY
 F1F1 1F        	RAR
 F1F2 E6FE      	ANI	11111110B	; ANY OTHER ERRORS?  (DELETED DATA OK)
 F1F4 C2FEF1    	JNZ	WERROR
                
                ;	READ OR WRITE IS OK, ACCUMULATOR CONTAINS ZERO
 F1F7 C9        	RET
                
                WREADY:				; NOT READY, TREAT AS ERROR FOR NOW
 F1F8 CD08F2    	CALL	INBYTE		; CLEAR RESULT BYTE
 F1FB C3FEF1    	JMP	TRYCOUNT
                
                WERROR:				; RETURN MALFUNCTION (CRC, TRACK, SEEK, ETC.)
                ;	THE MDS CONTROLLER HAS RETURNED A BIT IN EACH POSITION
                ;	OF THE ACCUMULATOR, CORRESPONDING TO THE CONDITIONS:
                ;	0	- DELETED DATA (ACCEPTED AS OK ABOVE)
                ;	1	- CRC ERROR
                ;	2	- SEEK ERROR
                ;	3	- ADDRESS ERROR (HARDWARE MALFUNCTION)
                ;	4	- DATA OVER/UNDER FLOW (HARDWARE MALFUNCTION)
                ;	5	- WRITE PROTECT (TREATED AS NOT READY)
                ;	6	- WRITE ERROR (HARDWARE MALFUNCTION)
                ;	7	- NOT READY
                ;	(ACCUMULATOR BITS ARE NUMBERED 7 6 5 4 3 2 1 0)
                
                TRYCOUNT:
                ;	REGISTER C CONTAINS RETRY COUNT, DECREMENT 'TIL ZERO
 F1FE 0D        	DCR	C
 F1FF C2C4F1    	JNZ	REWAIT		; FOR ANOTHER TRY
                
                ;	CANNOT RECOVER FROM ERROR
 F202 3E01      	MVI	A,1		; ERROR CODE
 F204 C9        	RET
                
 F205 DB89      INTYPE:	IN	RTYPE
 F207 C9        	RET
                
 F208 DB8B      INBYTE:	IN	RBYTE
 F20A C9        	RET
                
 F20B DB88      INSTAT:	IN	DSTAT
 F20D C9        	RET
                ;*************** END 201 CODE ***
                
                ;*************** IOC CONTROLLER DRIVER CODE ***********************************
                
                READI:				; READ NEXT DISK RECORD ( DISK/TRK/SEC/DMA SET)
 F20E 0E04      	MVI	C,READF		; SET TO READ FUNCTION
 F210 C315F2    	JMP	SETFUNCI
                ;
                WRITEI:				; DISK WRITE FUNCTION
 F213 0E06      	MVI	C,WRITF
                ;
                SETFUNCI:
                ;	SET FUNCTION FOR NEXT I/O (COMMAND IN REG-C)
 F215 3E80      	MVI	A,80H		; INITIALIZE IOPB FOR DUAL DENSITY 202
 F217 3299F3    	STA	IOPB		;	*
 F21A 219AF3    	LXI	H,IOF		; IO FUNCTION ADDRESS
 F21D 7E        	MOV	A,M		; GET IT TO ACCUMULATOR FOR MASKING
 F21E E6F8      	ANI	1111$1000B	; REMOVE PREVIOUS COMMAND
 F220 B1        	ORA	C		; SET TO NEW COMMAND
 F221 77        	MOV	M,A		; REPLACED IN IOPB
                
 F222 3AB8F5    	LDA	IOFSV		; RESTORE DRIVE ADDRESS
 F225 E640      	ANI	0100$0000B	; IOC ?
 F227 CAC2F1    	JZ	WAITIO		; NO - CONTINUE WITH DUAL
                
                ;* VERIFY DISK IS READY *
 F22A CD24F3    	CALL	DISABLE		; DISABLE INTERRUPTS
                SDSKSTAT:
 F22D 0E0A      	MVI	C,RETRY		; SET RETRY COUNT
                SDSK1:
 F22F CD0AF3    	CALL	DSKSTAT		; GET THE STATUS BYTE
 F232 F5        	PUSH	PSW		; SAVE STATUS BYTE
 F233 E601      	ANI	READY		; DISK READY ?
 F235 C240F2    	JNZ	SDSKSOK		; YES ... NO ERROR
                ;				  NO ... TEST FOR MAX RETRIES
 F238 0D        	DCR	C		; = MAX RETRIES?
 F239 CA40F3    	JZ	SDERROR		; YES ... REPORT ERROR
 F23C F1        	POP	PSW
 F23D C32FF2    	JMP	SDSK1		; RETRY!
                
                SDSKSOK:
 F240 F1        	POP	PSW		; RESTORE STATUS BYTE
 F241 E604      	ANI	OPCOMP		; ANY PENDING OPERATIONS ?
 F243 CA4CF2    	JZ	BLDIOPB		; NO - GO BUILD THE CONTROL BLOCK
                ;* CLEAR ANY ACTIVITY ON THE DISK DRIVE *
 F246 CD17F3    	CALL	DSKRSLT		; GET THE RESULT BYTE 
 F249 C32DF2    	JMP	SDSKSTAT	; GO MAKE SURE IT IS CLEARED
                
                ;**** MODIFY CONTROL BLOCK TO IOC FORMAT ***
                ;* BYTE TWO - MODIFY OP CODE *
                BLDIOPB:
                ;* BYTE 1
 F24C 3E00      	MVI	A,0H		; SET FIRST BYTE TO 0
 F24E 3299F3    	STA	IOPB		;
 F251 3A9AF3    	LDA	IOF		; PUT 202 OP CODE IN ACCUMULATOR
 F254 E607      	ANI	0000$0111B	; ISOLATE OP CODE
 F256 329AF3    	STA	IOF		; PUT BACK IN IOPB
                
                
 F259 0E0A      	MVI	C,RETRY		; INITIALIZE RETRY COUNTER
                ;* DETERMINE IF READ OR WRITE *
 F25B FE04      	CPI	READF		; READ ?
 F25D CA9DF2    	JZ	SDREAD		; YES - BRANCH
                
                
                ;*** BEGIN IOC WRITE ROUTINE ***
                SDWRITE:
 F260 CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO BE READY
 F263 3E17      	MVI	A,WDBC		; LOAD WRITE COMMAND
 F265 D3C1      	OUT	IOCCNTR		; ISSUE COMMAND TO IOC
 F267 CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO HANDLE COMMAND
 F26A 3A9BF3    	LDA	ION		; # OF SECTORS
 F26D D3C0      	OUT	IOCDATA		; SEND TO IOC
 F26F CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO HANDLE
                
                ;* PASS DATA TO IOC RAM *
 F272 2A9EF3    	LHLD	IOD		; LOAD ADDRESS OF DATA
 F275 3A9BF3    	LDA	ION		; LOAD NUMBER OF SECTORS
                SDWLP1:
 F278 F5        	PUSH	PSW		; SAVE SECTOR COUNT
 F279 1680      	MVI	D,128		; INITIALIZE BYTE COUNT FOR SECTOR
                SDWLP2:
 F27B 7E        	MOV	A,M		; PUT DATA IN ACCUMULATOR
 F27C D3C0      	OUT	IOCDATA		; PASS TO IOC RAM
 F27E CD58F3    	CALL	OUTWAIT		; WAIT FOR IOC TO HANDLE
 F281 23        	INX	H		; BUMP CHARACTER POINTER
 F282 15        	DCR	D		; DECREMENT CHARACTER COUNTER
 F283 C27BF2    	JNZ	SDWLP2		; LOOP TILL SECTOR DONE
 F286 F1        	POP	PSW		; LOAD SECTOR COUNT
 F287 3D        	DCR	A		; DECREMENT
 F288 C278F2    	JNZ	SDWLP1		; LOOP TILL END OF SECTORS
 F28B CDDAF2    	CALL	OUTIOPB		; PASS IOPB TO IOC
 F28E CD29F3    	CALL	ENABLE		; ENABLE INTERRUPTS
 F291 CDF7F2    	CALL	CKRESULT	; CHECK RESULTS OF WRITE
 F294 B7        	ORA	A		; SET FLAGS
 F295 C8        	RZ			; RETURN OF OK
 F296 0D        	DCR	C		; OVER RETRY LIMIT ?
 F297 C260F2    	JNZ	SDWRITE		; NO - TRY AGAIN
 F29A 3E01      	MVI	A,1		; ELSE SET BAD RETURN CODE
 F29C C9        	RET			; AND RETURN
                
                
                ;* IOC READ ROUTINE *
                
                SDREAD:
 F29D CD2EF3    	CALL	DBBWAIT		; WAIT FOR DBB TO BE READY
 F2A0 CDDAF2    	CALL	OUTIOPB		; SEND IOPB TO IOC
 F2A3 CDF7F2    	CALL	CKRESULT	; CHECK RESULT OF READ
 F2A6 B7        	ORA	A		; SET FLAGS
 F2A7 CAB4F2    	JZ	SDRDATA		; GET DATA IF OK
 F2AA 0D        	DCR	C		; BEYOND RETRY LIMIT ?
 F2AB C29DF2    	JNZ	SDREAD		; NO - TRY AGAIN
 F2AE CD29F3    	CALL	ENABLE		; ENABLE THE INTERRUPTS
 F2B1 3E01      	MVI	A,1		; ELSE SET BAD RETURN CODE
 F2B3 C9        	RET			; AND RETURN
                
                ;* GET THE DATA *
                SDRDATA:
 F2B4 CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO BE READY
 F2B7 3E19      	MVI	A,RDBC		; SET COMMAND TO GET THE DATA
 F2B9 D3C1      	OUT	IOCCNTR		; SEND TO IOC
 F2BB 2A9EF3    	LHLD	IOD		; LOAD DMA ADDRESS
 F2BE 3A9BF3    	LDA	ION		; LOAD NUMBER OF SECTORS
                SDRLP1:
 F2C1 F5        	PUSH	PSW		; SAVE SECTOR COUNT
 F2C2 1680      	MVI	D,128		; SET BYTES/SECTOR COUNT
                SDRLP2:
 F2C4 CD36F3    	CALL	INWAIT		; WAIT FOR A BYTE TO BE READY
 F2C7 DBC0      	IN	IOCDATA		; GET THE BYTE
 F2C9 77        	MOV	M,A		; MOVE TO BUFFER
 F2CA 23        	INX	H		; INCREMENT POINTER
 F2CB 15        	DCR	D		; DECREMENT CHARACTER COUNTER
 F2CC C2C4F2    	JNZ	SDRLP2		; LOOP THROUGH SECTOR
 F2CF F1        	POP	PSW		; LOAD SECTOR COUNTER
 F2D0 3D        	DCR	A		; DECREMENT
 F2D1 C2C1F2    	JNZ	SDRLP1		; LOOP THROUGH THE SECTORS
 F2D4 CD29F3    	CALL	ENABLE		; ENABLE INTERRUPTS AT END OF DATA
 F2D7 3E00      	MVI	A,0		; SET GOOD RETURN CODE
 F2D9 C9        	RET			; RETURN
                
                
                ;* IOC SUBROUTINES *
                
                ;* PASS THE IOPB *
                OUTIOPB:
 F2DA 2199F3    	LXI	H,IOPB		; POINT AT IOPB
 F2DD 1605      	MVI	D,5		; LOAD BYTE COUNTER
 F2DF 3E15      	MVI	A,WPBC		; LOAD COMMAND FOR IOC
 F2E1 C3E6F2    	JMP	SDWPB		; GO ISSUE THE COMMAND
                SDWPBL1:
 F2E4 3E16      	MVI	A,WPBCC		; LOAD COMMAND FOR IOC
                SDWPB:
 F2E6 D3C1      	OUT	IOCCNTR		; OUTPUT COMMAND TO IOC
 F2E8 CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO HANDLE
 F2EB 7E        	MOV	A,M		; PUT DATA IN ACCUMULATOR
 F2EC D3C0      	OUT	IOCDATA		; PASS TO IOC
 F2EE CD58F3    	CALL	OUTWAIT		; WAIT FOR IOC TO HANDLE
 F2F1 23        	INX	H		; INCREMENT CHARACTER POINTER
 F2F2 15        	DCR	D		; DECREMENT CHARACTER COUNTER
 F2F3 C2E4F2    	JNZ	SDWPBL1		; LOOP THROUGH IOPB
 F2F6 C9        	RET			; RETURN
                
                ;* CHECK RESULTS OF I/O *
                CKRESULT:
 F2F7 CD6DF3    	CALL	DSKWAIT		; WAIT FOR WRITE TO COMPLETE
                
 F2FA CD17F3    	CALL	DSKRSLT		; GET THE RESULT BYTE
 F2FD 57        	MOV	D,A		; SAVE
 F2FE E6FE      	ANI	1111$1110B	; DELETED DATA ?
 F300 C8        	RZ			; YES - RETURN (OK FOR NOW)
 F301 7A        	MOV	A,D		; RESTORE BYTE
 F302 E604      	ANI	SEEKERR		; SEEK ERROR ?
 F304 C447F3    	CNZ	RECALIB		; YES - TRY TO RECOVER
 F307 3E01      	MVI	A,1		; SET BAD RETURN CODE
 F309 C9        	RET			; RETURN
                
                ;* GET DISK STATUS BYTE *
                DSKSTAT:
 F30A CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO BE FREE
 F30D 3E1C      	MVI	A,RDSTS			; SET COMMAND FOR OUTPUT
 F30F D3C1      	OUT	IOCCNTR		; ISSUE COMMAND
 F311 CD36F3    	CALL	INWAIT		; WAIT FOR DATA TO BE READY
 F314 DBC0      	IN	IOCDATA		; GET THE RESULT BYTE
 F316 C9        	RET			; RETURN
                
                ;* GET DISK RESULT BYTE *
                DSKRSLT:
 F317 CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO BE FREE
 F31A 3E1B      	MVI	A,RRSTS		; SET UP COMMAND FOR OUTPUT
 F31C D3C1      	OUT	IOCCNTR		; ISSUE COMMAND
 F31E CD36F3    	CALL	INWAIT		; WAIT FOR COMMAND TO COMPLETE
 F321 DBC0      	IN	IOCDATA		; READ RESULT BYTE
 F323 C9        	RET			; RETURN
                
                ;* DISABLE INTERRUPTS *
                DISABLE:
 F324 3E0D      	MVI	A,0DH		; SET DISABLE COMMAND
 F326 D3FF      	OUT	0FFH		; WRITE TO CONTROL PORT
 F328 C9        	RET			; RETURN
                
                ;* ENABLE INTERRUPTS *
                ENABLE:
 F329 3E05      	MVI	A,05H		; SET ENABLE COMMAND
 F32B D3FF      	OUT	0FFH		; WRITE TO CONTROL PORT
 F32D C9        	RET			; RETURN
                
                ;* WAIT FOR IOC TO BE FREE *
                DBBWAIT:
 F32E DBC1      	IN	IOCCNTR		; READ DBB STATUS BYTE
 F330 E607      	ANI	F0 OR OBF OR IBF	; ANYTHING PENDING
 F332 C22EF3    	JNZ	DBBWAIT		; YES - SPIN
 F335 C9        	RET			; ELSE RETURN
                
                ;* WAIT FOR INPUT TO BE READY *
                INWAIT:
 F336 DBC1      	IN	IOCCNTR		; GET THE IOC STATUS BYTE
 F338 E607      	ANI	OBF OR F0 OR IBF	; OUTPUT BUFFER FULL ?
 F33A FE01      	CPI	OBF		; VALID BUFFER ?
 F33C C236F3    	JNZ	INWAIT		; NO - SPIN
 F33F C9        	RET			; RETURN
                
                
                ;* DISK NOT READY *
                SDERROR:
 F340 F1        	POP	PSW		; CLEAN UP STACK
 F341 CD29F3    	CALL	ENABLE		; ENABLE INTERRUPTS
 F344 3E01      	MVI	A,1		; SET RETURN CODE
 F346 C9        	RET			; RETURN
                
                ;* RECALIBRATE DISK DRIVE *
                RECALIB:
 F347 3A9AF3    	LDA	IOF		; LOAD CURRENT OP CODE
 F34A F5        	PUSH	PSW		; SAVE
 F34B 3E03      	MVI	A,RECALB	; SET RECALIBRATE OP CODE
 F34D 329AF3    	STA	IOF		; STORE IN IOPB
 F350 CDDAF2    	CALL	OUTIOPB		; SEND IOBP TO IOC
 F353 F1        	POP	PSW		; RELOAD OP CODE
 F354 329AF3    	STA	IOF		; PUT BACK IN IOPB
 F357 C9        	RET			; RETURN
                
                ;* WAIT FOR IOC TO TAKE DATA ON WRITE *
                OUTWAIT:
 F358 DBC1      	IN	IOCCNTR		; READ STATUS PORT
 F35A E606      	ANI	IBF OR F0		; DATA TAKEN ?
 F35C C258F3    	JNZ	OUTWAIT		; NO - SPIN
 F35F C9        	RET	3E00C92199F316053E86
:10F2E00015C3E6F23E16D3C1CD2EF37ED3C0CD5862
:10F2F000F32315C2E4F2C9CD6DF3CD17F357E6FE43
:10F30000C87AE604C447F33E01C9CD2EF33E1CD3B0
:10F31000C1CD36F3DBC0C9CD2EF33E1BD3C1CD36F4
:10F32000F3DBC0C93E0DD3FFC93E05D3FFC9DBC126
:10F33000E607C22EF3C9DBC1E607FE01C236F3C9F8
:10F34000F1CD29F33E01C93A9AF3F53E03329AF31F
:10F35000CDDAF2F1329AF3C9DBC1E606C258F3C93D
:10F36000CD2EF33E88D3C1CD36F3DBC0C9CD0AF331
:10F37000E604CA6DF3C97EB7C8E54FCDC0F0E123FE
:10F38000C376F30D0A36324B2043502F4D2056459D
:10F39000525320322E320D0A0080040102018000F7
:10F3A000001020304000000000000000002DF4F5A7
:10F3B000F3CCF4ADF400000000000000002DF4F5E3
:10F3C000F30BF5ECF413F40000000000002DF4043E
:10F3D000F44AF52BF513F40000000000002DF404AE
:10F3E000F479F55AF513F40000000000002DF40440
:10F3F000F4A8F589F53400040F01F2007F00C00085
:10F40000200002001A00030700F2003F00C00010B5
:10F4100000020001070D1319050B111703090F1541
:0DF4200002080E141A060C1218040A101629
:0000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                		; RETURN WHEN TAKEN
                
                ;* GET DEVICE STATUS *
                DEVSTAT:
 F360 CD2EF3    	CALL	DBBWAIT		; WAIT FOR IOC TO BE READY
 F363 3E88      	MVI	A,DSTAT		; SET OP CODE FOR GET STATUS BYTE
 F365 D3C1      	OUT	IOCCNTR		; SEND TO IOC
 F367 CD36F3    	CALL	INWAIT		; WAIT FOR IT TO BE READY
 F36A DBC0      	IN	IOCDATA		; GET IT
 F36C C9        	RET			; RETURN
                
                ;* WAIT FOR DISK TO BE READY *
                DSKWAIT:
 F36D CD0AF3    	CALL	DSKSTAT		; GET DISK STATUS
 F370 E604      	ANI	OPCOMP		; OPERATION COMPLETED ?
 F372 CA6DF3    	JZ	DSKWAIT		; NO - SPIN
 F375 C9        	RET			; ELSE RETURN
                ;*************** END IOC CODE ***
                
                ;******************************************************************************
                ;		UTILITY SUBROUTINES
                
                PRMSG:				; PRINT MESSAGE AT H,L TO 0
 F376 7E        	MOV	A,M		;
 F377 B7        	ORA	A		; END OF STRING?
 F378 C8        	RZ			; YES
 F379 E5        	PUSH	H		; NO - PRINT THIS CHARACTER
 F37A 4F        	MOV	C,A		;
 F37B CDC0F0    	CALL	CONOUT		;
 F37E E1        	POP	H		;
 F37F 23        	INX	H		;
 F380 C376F3    	JMP	PRMSG		;
                
                ;******************************************************************************
                ;		DATA AREA
                ;******************************************************************************
                
                SIGNON:				;SIGNON MESSAGE: XXK CP/M VERS X.Y
 F383 0D0A      	DB	CR,LF
 F385 3632      	DB	MSIZE/10+'0',MSIZE MOD 10 + '0'
 F387 4B2043502F	DB	'K CP/M VERS '
 F393 322E320D0A	DB	VERS/10+'0','.',VERS MOD 10+'0',CR,LF
 F398 00        	DB	0		; END OF SIGNON MESSAGE
                
                IOPB:				; IO PARAMETER BLOCK
 F399 80        	DB	80H		; NORMAL I/O OPERATION
 F39A 04        IOF:	DB	READF		; IO FUNCTION, INITIAL READ
 F39B 01        ION:	DB	1		; NUMBER OF SECTORS TO READ
 F39C 02        IOT:	DB	2		; TRACK NUMBER
 F39D 01        IOS:	DB	1		; SECTOR NUMBER
 F39E 8000      IOD:	DW	BUFF		; IO ADDRESS
                
                SEL$TABLE:			;* DRIVE SELECT BITS *
 F3A0 0010203040	DB	00H,10H,20H,30H,40H
                	DISKS	NUM$DISKS	; GENERATE DRIVE TABLES
 F3A5+=         DPBASE	EQU	$	;BASE OF DISK PARAMETER BLOCKS
 F3A5+00000000  DPE0:	DW	XLT0,0000H	;TRANSLATE TABLE
 F3A9+00000000  	DW	0000H,0000H	;SCRATCH AREA
 F3AD+2DF4F5F3  	DW	DIRBUF,DPB0	;DIR BUFF,PARM BLOCK
 F3B1+CCF4ADF4  	DW	CSV0,ALV0	;CHECK, ALLOC VECTORS
 F3B5+00000000  DPE1:	DW	XLT1,0000H	;TRANSLATE TABLE
 F3B9+00000000  	DW	0000H,0000H	;SCRATCH AREA
 F3BD+2DF4F5F3  	DW	DIRBUF,DPB1	;DIR BUFF,PARM BLOCK
 F3C1+0BF5ECF4  	DW	CSV1,ALV1	;CHECK, ALLOC VECTORS
 F3C5+13F40000  DPE2:	DW	XLT2,0000H	;TRANSLATE TABLE
 F3C9+00000000  	DW	0000H,0000H	;SCRATCH AREA
 F3CD+2DF404F4  	DW	DIRBUF,DPB2	;DIR BUFF,PARM BLOCK
 F3D1+4AF52BF5  	DW	CSV2,ALV2	;CHECK, ALLOC VECTORS
 F3D5+13F40000  DPE3:	DW	XLT3,0000H	;TRANSLATE TABLE
 F3D9+00000000  	DW	0000H,0000H	;SCRATCH AREA
 F3DD+2DF404F4  	DW	DIRBUF,DPB3	;DIR BUFF,PARM BLOCK
 F3E1+79F55AF5  	DW	CSV3,ALV3	;CHECK, ALLOC VECTORS
 F3E5+13F40000  DPE4:	DW	XLT4,0000H	;TRANSLATE TABLE
 F3E9+00000000  	DW	0000H,0000H	;SCRATCH AREA
 F3ED+2DF404F4  	DW	DIRBUF,DPB4	;DIR BUFF,PARM BLOCK
 F3F1+A8F589F5  	DW	CSV4,ALV4	;CHECK, ALLOC VECTORS
                
                	DISKDEF 0,1,52,,2048,243,128,128,2
 F3F5+=         DPB0	EQU	$		;DISK PARM BLOCK
 F3F5+3400      	DW	52		;SEC PER TRACK
 F3F7+04        	DB	4		;BLOCK SHIFT
 F3F8+0F        	DB	15		;BLOCK MASK
 F3F9+01        	DB	1		;EXTNT MASK
 F3FA+F200      	DW	242		;DISK SIZE-1
 F3FC+7F00      	DW	127		;DIRECTORY MAX
 F3FE+C0        	DB	192		;ALLOC0
 F3FF+00        	DB	0		;ALLOC1
 F400+2000      	DW	32		;CHECK SIZE
 F402+0200      	DW	2		;OFFSET
 0000+=         XLT0	EQU	0		;NO XLATE TABLE
                
                	DISKDEF	1,0
 F3F5+=         DPB1	EQU	DPB0	;EQUIVALENT PARAMETERS
 001F+=         ALS1	EQU	ALS0	;SAME ALLOCATION VECTOR SIZE
 0020+=         CSS1	EQU	CSS0	;SAME CHECKSUM VECTOR SIZE
 0000+=         XLT1	EQU	XLT0	;SAME TRANSLATE TABLE
                
                	DISKDEF 2,1,26,6,1024,243,64,64,2
 F404+=         DPB2	EQU	$		;DISK PARM BLOCK
 F404+1A00      	DW	26		;SEC PER TRACK
 F406+03        	DB	3		;BLOCK SHIFT
 F407+07        	DB	7		;BLOCK MASK
 F408+00        	DB	0		;EXTNT MASK
 F409+F200      	DW	242		;DISK SIZE-1
 F40B+3F00      	DW	63		;DIRECTORY MAX
 F40D+C0        	DB	192		;ALLOC0
 F40E+00        	DB	0		;ALLOC1
 F40F+1000      	DW	16		;CHECK SIZE
 F411+0200      	DW	2		;OFFSET
 F413+=         XLT2	EQU	$		;TRANSLATE TABLE
 F413+01        	DB	1		
 F414+07        	DB	7		
 F415+0D        	DB	13		
 F416+13        	DB	19		
 F417+19        	DB	25		
 F418+05        	DB	5		
 F419+0B        	DB	11		
 F41A+11        	DB	17		
 F41B+17        	DB	23		
 F41C+03        	DB	3		
 F41D+09        	DB	9		
 F41E+0F        	DB	15		
 F41F+15        	DB	21		
 F420+02        	DB	2		
 F421+08        	DB	8		
 F422+0E        	DB	14		
 F423+14        	DB	20		
 F424+1A        	DB	26		
 F425+06        	DB	6		
 F426+0C        	DB	12		
 F427+12        	DB	18		
 F428+18        	DB	24		
 F429+04        	DB	4		
 F42A+0A        	DB	10		
 F42B+10        	DB	16		
 F42C+16        	DB	22		
                
                	DISKDEF	3,2
 F404+=         DPB3	EQU	DPB2	;EQUIVALENT PARAMETERS
 001F+=         ALS3	EQU	ALS2	;SAME ALLOCATION VECTOR SIZE
 0010+=         CSS3	EQU	CSS2	;SAME CHECKSUM VECTOR SIZE
 F413+=         XLT3	EQU	XLT2	;SAME TRANSLATE TABLE
                
                	DISKDEF	4,2
 F404+=         DPB4	EQU	DPB2	;EQUIVALENT PARAMETERS
 001F+=         ALS4	EQU	ALS2	;SAME ALLOCATION VECTOR SIZE
 0010+=         CSS4	EQU	CSS2	;SAME CHECKSUM VECTOR SIZE
 F413+=         XLT4	EQU	XLT2	;SAME TRANSLATE TABLE
                
                	ENDEF
 F42D+=         BEGDAT	EQU	$
 F42D+          DIRBUF:	DS	128	;DIRECTORY ACCESS BUFFER
 F4AD+          ALV0:	DS	31
 F4CC+          CSV0:	DS	32
 F4EC+          ALV1:	DS	31
 F50B+          CSV1:	DS	32
 F52B+          ALV2:	DS	31
 F54A+          CSV2:	DS	16
 F55A+          ALV3:	DS	31
 F579+          CSV3:	DS	16
 F589+          ALV4:	DS	31
 F5A8+          CSV4:	DS	16
 F5B8+=         ENDDAT	EQU	$
 018B+=         DATSIZ	EQU	$-BEGDAT
                
 F5B8           IOFSV	DS	1		; SAVE AREA FOR DRIVE ADDRESS
 F5B9           HOLD$5	DS	1
                	IF	RELOC
                	DB	0	; FORCE OUT LAST ADDRESS FOR RELOCATION
                	ENDIF
                
 F5BA           	END
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                001F ALS1	001F ALS3	001F ALS4	F4AD ALV0	F4EC ALV1
F52B ALV2	F55A ALV3	F589 ALV4	0078 BASE2	0088 BASE
E200 BDOS	F42D BEGDAT	F000 BIOS	F24C BLDIOPB	F033 BOOT
0080 BUFF	F0E6 CALLER	DA00 CCP	0008 CD		0004 CDISK
F803 CI		F0BC CI1	F2F7 CKRESULT	F809 CO		F0B6 CONIN
F0C0 CONOUT	F0C4 CONSTAT	1600 CPML	000D CR		0020 CSS1
0010 CSS3	0010 CSS4	F812 CSTS	F4CC CSV0	F50B CSV1
F54A CSV2	F579 CSV3	F5A8 CSV4	018B DATSIZ	F32E DBBWAIT
F360 DEVSTAT	F42D DIRBUF	F324 DISABLE	F3F5 DPB0	F3F5 DPB1
F404 DPB2	F404 DPB3	F404 DPB4	F3A5 DPBASE	F3A5 DPE0
F3B5 DPE1	F3C5 DPE2	F3D5 DPE3	F3E5 DPE4	0080 DSKERR
F317 DSKRSLT	F30A DSKSTAT	F36D DSKWAIT	0078 DSTAT2	0088 DSTAT
F329 ENABLE	F5B8 ENDDAT	0004 F0		0000 FALSE	F04C FILLLOOP
F08C GOCPM	F5B9 HOLD5	F108 HOME	0002 IBF	007A IHIGH2
008A IHIGH	0020 ILLDATA	0040 ILLSTAT	0079 ILOW2	0089 ILOW
F1A1 INBYTE2	F208 INBYTE	F1A4 INSTAT2	F20B INSTAT	00FC INTCONT0
00FD INTCONT1	007E INTMASK	F19E INTYPE2	F205 INTYPE	F336 INWAIT
0003 IOBYTE	0081 IOBYTI	00C1 IOCCNTR	00C0 IOCDATA	F39E IOD
F39A IOF	F5B8 IOFSV	F39B ION	F399 IOPB	0004 IORDY
F39D IOS	F39C IOT	000A LF		F0C8 LIST	F0E7 LISTST
F80F LO		F800 MON80	00F3 MONINT	F0D4 MON	003E MSIZE
002C NSECTS	0005 NUMDISKS	0001 OBF	0004 OPCOMP	F2DA OUTIOPB
F358 OUTWAIT	F80C PO		0008 PRESENT	F376 PRMSG	F0D0 PUNCH
F800 RAMTOP	007B RBYTE2	008B RBYTE	0019 RDBC	0003 RDSTAT
001C RDSTS	F1A7 READ1	F14A READ2	F0CC READER	0004 READF
F126 READ	F20E READI	0001 READY	0003 RECAL	0003 RECALB
F347 RECALIB	0000 RELOC	000A RETRY	F160 REWAIT2	F1C4 REWAIT
F806 RI		FF0F RMON80	001B RRSTS	0079 RTYPE2	0089 RTYPE
F340 SDERROR	F2B4 SDRDATA	F29D SDREAD	F2C1 SDRLP1	F2C4 SDRLP2
F22F SDSK1	F240 SDSKSOK	F22D SDSKSTAT	F278 SDWLP1	F27B SDWLP2
F2E6 SDWPB	F2E4 SDWPBL1	F260 SDWRITE	F11A SECTTRAN	0004 SEEKERR
F0E9 SELDSK	F3A0 SELTABLE	F114 SETDMA	F151 SETFUNC2	F1AE SETFUNC
F215 SETFUNCI	F10F SETSEC	F10A SETTRK	F383 SIGNON	FFFF TRUE
F197 TRYCOUNT2	F1FE TRYCOUNT	0016 VERS	F16F WAIT02	F1D6 WAIT0
F15E WAITIO2	F1C2 WAITIO	F069 WBOOT0	F003 WBOOTE	F066 WBOOT
0017 WDBC	F197 WERROR2	F1FE WERROR	0015 WPBC	0016 WPBCC
F191 WREADY2	F1F8 WREADY	F138 WRITE	F1AC WRITE1	F14F WRITE2
F213 WRITEI	0006 WRITF	0000 XLT0	0000 XLT1	F413 XLT2
F413 XLT3	F413 XLT4
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                	title   'mds cold start loader at 3000h'
;
;	mds-800 cold start loader for cp/m 2.0
;
;	version 2.0 august, 1979
;
false	equ	0
true	equ	not false
testing	equ	false    	;if true, then go to mon80 on  errors
;
	if	testing
bias	equ	03400h
	endif
	if	not testing
bias	equ	0da00h		;for 62K system
	endif
cpmb	equ	bias		;base of dos load
bdos	equ	806h+bias	;entry to dos for calls
bdose	equ	1880h+bias	;end of dos load
boot	equ	1600h+bias	;cold start entry point
rboot	equ	boot+3		;warm start entry point
;
	org	03000h		;loaded down from hardware boot at 3000H
;
bdosl	equ	bdose-cpmb
ntrks	equ	2		;number of tracks to read
bdoss	equ	bdosl/128	;number of sectors in dos
bdoso	equ	25		;number of bdos sectors on track 0
bdos1	equ	bdoss-bdoso	;number of sectors on track 1
;
mon80	equ	0f800h		;intel monitor base
rmon80	equ	0ff0fh		;restart location for mon80
base	equ	078h		;'base' used by controller
rtype	equ	base+1		;result type
rbyte	equ	base+3		;result byte
reset	equ	base+7		;reset controller
;
;
dstat	equ	base		;disk status port
ilow	equ	base+1		;low iopb address
ihigh	equ	base+2		;high iopb address
bsw	equ	0ffh		;boot switch
recal	equ	3h		;recalibrate selected drive
readf	equ	4h		;disk read function
stack	equ	100h		;use end of boot for stack
;
rstart:
	lxi	sp,stack;	;in case of call to mon80
;	clear disk status
	in	rtype
	in	rbyte
;	check if boot switch is off
coldstart:
	in 	bsw
	ani	02h		;switch on?
	jnz	coldstart
;	clear the controller
	out	reset		;logic cleared
;
;
	mvi	b,ntrks		;number of tracks to read
	lxi	h,iopbo
;
start:
;
;	read first/next track into cpmb
	mov	a,l
	out	ilow
	mov	a,h
	out	ihigh
waito:	in	dstat
	ani	4
	jz	waito
;
;	check	disk status
	in	rtype
	ani	11b
	cpi	2
;
	if	testing
	cnc	rmon80		;go to monitor if 11 or 10
	endif
	if	not testing
	jnc	rstart		;retry the load
	endif
;
	in	rbyte		;i/o complete, check status
;	if not	ready, then go to mon80
	ral
	cc	rmon80		;not ready bit set
	rar			;restore
	ani	11110b		;overrun/addr err/seek/crc/xxxx
;
	if	testing
	cnz	rmon80		;go to monitor
	endif
	if	not testing
	jnz	rstart		;retry the load
	endif
;
;
	lxi	d,iopbl		;length of iopb
	dad	d		;addressing next iopb
	dcr	b		;count down tracks
	jnz	start
;
;
;	jmp to boot to print initial message, and set up jmps
	jmp	boot
;
;	parameter blocks
iopbo:	db	80h		;iocw, no update
	db	readf		;read function
	db	bdoso		;*sectors to read on track 0
	db	0		;track 0
	db	2		;start with sector 2 on track 0
	dw	cpmb		;start at base of bdos
iopbl	equ	$-iopbo
;
iopb1:	db	80h
	db	readf
	db	bdos1		;sectors to read on track 1
	db	1		;track 1
	db	1		;sector 1
	dw	cpmb+bdoso*128	;base of second read
;
	end
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               CP/M MACRO ASSEM 2.0	#001	mds cold start loader at 3000h

                	TITLE   'mds cold start loader at 3000h'
                ;
                ;	MDS-800 COLD START LOADER FOR CP/M 2.0
                ;
                ;	VERSION 2.0 AUGUST, 1979
                ;
 0000 =         FALSE	EQU	0
 FFFF =         TRUE	EQU	NOT FALSE
 0000 =         TESTING	EQU	FALSE    	;IF TRUE, THEN GO TO MON80 ON  ERRORS
                ;
                	IF	TESTING
                BIAS	EQU	03400H
                	ENDIF
                	IF	NOT TESTING
 DA00 =         BIAS	EQU	0DA00H		;FOR 62K SYSTEM
                	ENDIF
 DA00 =         CPMB	EQU	BIAS		;BASE OF DOS LOAD
 E206 =         BDOS	EQU	806H+BIAS	;ENTRY TO DOS FOR CALLS
 F280 =         BDOSE	EQU	1880H+BIAS	;END OF DOS LOAD
 F000 =         BOOT	EQU	1600H+BIAS	;COLD START ENTRY POINT
 F003 =         RBOOT	EQU	BOOT+3		;WARM START ENTRY POINT
                ;
 3000           	ORG	03000H		;LOADED DOWN FROM HARDWARE BOOT AT 3000H
                ;
 1880 =         BDOSL	EQU	BDOSE-CPMB
 0002 =         NTRKS	EQU	2		;NUMBER OF TRACKS TO READ
 0031 =         BDOSS	EQU	BDOSL/128	;NUMBER OF SECTORS IN DOS
 0019 =         BDOSO	EQU	25		;NUMBER OF BDOS SECTORS ON TRACK 0
 0018 =         BDOS1	EQU	BDOSS-BDOSO	;NUMBER OF SECTORS ON TRACK 1
                ;
 F800 =         MON80	EQU	0F800H		;INTEL MONITOR BASE
 FF0F =         RMON80	EQU	0FF0FH		;RESTART LOCATION FOR MON80
 0078 =         BASE	EQU	078H		;'BASE' USED BY CONTROLLER
 0079 =         RTYPE	EQU	BASE+1		;RESULT TYPE
 007B =         RBYTE	EQU	BASE+3		;RESULT BYTE
 007F =         RESET	EQU	BASE+7		;RESET CONTROLLER
                ;
                ;
 0078 =         DSTAT	EQU	BASE		;DISK STATUS PORT
 0079 =         ILOW	EQU	BASE+1		;LOW IOPB ADDRESS
 007A =         IHIGH	EQU	BASE+2		;HIGH IOPB ADDRESS
 00FF =         BSW	EQU	0FFH		;BOOT SWITCH
 0003 =         RECAL	EQU	3H		;RECALIBRATE SELECTED DRIVE
 0004 =         READF	EQU	4H		;DISK READ FUNCTION
 0100 =         STACK	EQU	100H		;USE END OF BOOT FOR STACK
                ;
                RSTART:
 3000 310001    	LXI	SP,STACK;	;IN CASE OF CALL TO MON80
                ;	CLEAR DISK STATUS
 3003 DB79      	IN	RTYPE
 3005 DB7B      	IN	RBYTE
                ;	CHECK IF BOOT SWITCH IS OFF
                COLDSTART:
 3007 DBFF      	IN 	BSW
 3009 E602      	ANI	02H		;SWITCH ON?
 300B C20730    	JNZ	COLDSTART
CP/M MACRO ASSEM 2.0	#002	mds cold start loader at 3000h

                ;	CLEAR THE CONTROLLER
 300E D37F      	OUT	RESET		;LOGIC CLEARED
                ;
                ;
 3010 0602      	MVI	B,NTRKS		;NUMBER OF TRACKS TO READ
 3012 214230    	LXI	H,IOPBO
                ;
                START:
                ;
                ;	READ FIRST/NEXT TRACK INTO CPMB
 3015 7D        	MOV	A,L
 3016 D379      	OUT	ILOW
 3018 7C        	MOV	A,H
 3019 D37A      	OUT	IHIGH
 301B DB78      WAITO:	IN	DSTAT
 301D E604      	ANI	4
 301F CA1B30    	JZ	WAITO
                ;
                ;	CHECK	DISK STATUS
 3022 DB79      	IN	RTYPE
 3024 E603      	ANI	11B
 3026 FE02      	CPI	2
                ;
                	IF	TESTING
                	CNC	RMON80		;GO TO MONITOR IF 11 OR 10
                	ENDIF
                	IF	NOT TESTING
 3028 D20030    	JNC	RSTART		;RETRY THE LOAD
                	ENDIF
                ;
 302B DB7B      	IN	RBYTE		;I/O COMPLETE, CHECK STATUS
                ;	IF NOT	READY, THEN GO TO MON80
 302D 17        	RAL
 302E DC0FFF    	CC	RMON80		;NOT READY BIT SET
 3031 1F        	RAR			;RESTORE
 3032 E61E      	ANI	11110B		;OVERRUN/ADDR ERR/SEEK/CRC/XXXX
                ;
                	IF	TESTING
                	CNZ	RMON80		;GO TO MONITOR
                	ENDIF
                	IF	NOT TESTING
 3034 C20030    	JNZ	RSTART		;RETRY THE LOAD
                	ENDIF
                ;
                ;
 3037 110700    	LXI	D,IOPBL		;LENGTH OF IOPB
 303A 19        	DAD	D		;ADDRESSING NEXT IOPB
 303B 05        	DCR	B		;COUNT DOWN TRACKS
 303C C21530    	JNZ	START
                ;
                ;
                ;	JMP TO BOOT TO PRINT INITIAL MESSAGE, AND SET UP JMPS
 303F C300F0    	JMP	BOOT
                ;
                ;	PARAMETER BLOCKS
 3042 80        IOPBO:	DB	80H		;IOCW, NO UPDATE
CP/M MACRO ASSEM 2.0	#003	mds cold start loader at 3000h

 3043 04        	DB	READF		;READ FUNCTION
 3044 19        	DB	BDOSO		;*SECTORS TO READ ON TRACK 0
 3045 00        	DB	0		;TRACK 0
 3046 02        	DB	2		;START WITH SECTOR 2 ON TRACK 0
 3047 00DA      	DW	CPMB		;START AT BASE OF BDOS
 0007 =         IOPBL	EQU	$-IOPBO
                ;
 3049 80        IOPB1:	DB	80H
 304A 04        	DB	READF
 304B 18        	DB	BDOS1		;SECTORS TO READ ON TRACK 1
 304C 01        	DB	1		;TRACK 1
 304D 01        	DB	1		;SECTOR 1
 304E 80E6      	DW	CPMB+BDOSO*128	;BASE OF SECOND READ
                ;
 3050           	END
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0078 BASE	E206 BDOS	0018 BDOS1	F280 BDOSE	1880 BDOSL
0019 BDOSO	0031 BDOSS	DA00 BIAS	F000 BOOT	00FF BSW
3007 COLDSTART	DA00 CPMB	0078 DSTAT	0000 FALSE	007A IHIGH
0079 ILOW	3049 IOPB1	0007 IOPBL	3042 IOPBO	F800 MON80
0002 NTRKS	F003 RBOOT	007B RBYTE	0004 READF	0003 RECAL
007F RESET	FF0F RMON80	3000 RSTART	0079 RTYPE	0100 STACK
3015 START	0000 TESTING	FFFF TRUE	301B WAITO
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                :10300000310001DB79DB7BDBFFE602C20730D37FD7
:1030100006022142307DD3797CD37ADB78E604CA7C
:103020001B30DB79E603FE02D20030DB7B17DC0FBE
:10303000FF1FE61EC200301107001905C21530C37C
:1030400000F0800419000200DA800418010180E613
:0000000000
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                